{"componentChunkName":"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx","path":"/blog/vue3-compat","result":{"data":{"post":{"__typename":"MdxPost","slug":"/blog/vue3-compat","title":"Vue3 Compat","date":"30.09.2020","tags":[{"name":"SourceCode","slug":"source-code"},{"name":"Front End Framework","slug":"front-end-framework"}],"description":"Vue3 Compat","body":"function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Vue3 Compat\",\n  \"slug\": \"/blog/vue3-compat\",\n  \"date\": \"2020-09-30T00:00:00.000Z\",\n  \"author\": \"ahabhgk\",\n  \"description\": \"Vue3 Compat\",\n  \"tags\": [\"SourceCode\", \"Front End Framework\"]\n};\n\nvar makeShortcode = function makeShortcode(name) {\n  return function MDXDefaultShortcode(props) {\n    console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n    return mdx(\"div\", props);\n  };\n};\n\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"h2\", {\n    \"id\": \"table-of-contents\"\n  }, \"Table of Contents\"), mdx(\"div\", {\n    className: \"table-of-contents\"\n  }, mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"#%E5%BA%8F\"\n  }), \"\\u5E8F\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"#fragment\"\n  }), \"Fragment\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"#teleport\"\n  }), \"Teleport\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"#inject--provide\"\n  }), \"Inject / Provide\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"#onerrorcaptured\"\n  }), \"onErrorCaptured\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"#suspense\"\n  }), \"Suspense\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"#defineasynccomponent\"\n  }), \"defineAsyncComponent\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"#keepalive\"\n  }), \"KeepAlive\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"#transition\"\n  }), \"Transition\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"#ref\"\n  }), \"Ref\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"#complier-%E4%BC%98%E5%8C%96\"\n  }), \"Complier \\u4F18\\u5316\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"#-ramble\"\n  }), \"\\uD83D\\uDE03 ramble\")))), mdx(\"h2\", {\n    \"id\": \"序\"\n  }, \"\\u5E8F\"), mdx(\"p\", null, \"Vue3 \\u4E2D\\u5185\\u7F6E\\u7EC4\\u4EF6\\u548C\\u4E00\\u4E9B\\u5176\\u4ED6\\u65B0\\u7279\\u6027\\u7684\\u5B9E\\u73B0\\u539F\\u7406\\uFF0C\\u4F5C\\u4E3A\\u4E0A\\u4E00\\u7BC7\\u7684\\u8865\\u5145\"), mdx(\"h2\", {\n    \"id\": \"fragment\"\n  }, \"Fragment\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-js:title=runtime-core/components/fragment.js\",\n    \"metastring\": \"{15,19,36-38}\",\n    \"{15,19,36-38}\": true\n  }), \"export const Fragment = {\\n  patch(\\n    { mountChildren, patchChildren, renderOptions },\\n    { n1, n2, container, isSVG, anchor }\\n  ) {\\n    if (n1 == null) {\\n      const {\\n        createText: hostCreateText,\\n        insert: hostInsert,\\n      } = renderOptions\\n      const fragmentStartAnchor = n2.node = hostCreateText('')\\n      const fragmentEndAnchor = n2.anchor = hostCreateText('')\\n      hostInsert(fragmentStartAnchor, container, anchor)\\n      hostInsert(fragmentEndAnchor, container, anchor)\\n      mountChildren(n2, container, isSVG, fragmentEndAnchor)\\n    } else {\\n      n2.node = n1.node\\n      n2.anchor = n1.anchor\\n      patchChildren(n1, n2, container, isSVG)\\n    }\\n  },\\n\\n  getNode(internals, { vnode }) { // \\u63D2\\u5165\\u5230\\u5B83\\u7684\\u524D\\u9762\\uFF0C\\u9700\\u8981\\u4ECE\\u5934\\u90E8\\u62FF\\n    return vnode.node\\n  },\\n\\n  getNextSibling({ renderOptions }, { vnode }) { // nextSibling \\u9700\\u8981\\u4ECE\\u5C3E\\u90E8\\u62FF\\n    return renderOptions.nextSibling(vnode.anchor)\\n  },\\n\\n  move({ move, renderOptions }, { vnode, container, anchor }) {\\n    const { insert: hostInsert } = renderOptions\\n    const fragmentStartAnchor = vnode.node\\n    const fragmentEndAnchor = vnode.anchor\\n    hostInsert(fragmentStartAnchor, container, anchor)\\n    for (let child of vnode.children) {\\n      move(child, container, anchor)\\n    }\\n    hostInsert(fragmentEndAnchor, container, anchor)\\n  },\\n\\n  unmount({ unmount, renderOptions }, { vnode, doRemove }) {\\n    const { remove: hostRemove } = renderOptions\\n    hostRemove(vnode.node)\\n    vnode.children.forEach(c => unmount(c, doRemove))\\n    hostRemove(vnode.anchor)\\n  },\\n}\\n\")), mdx(\"p\", null, \"\\u8FD9\\u4E94\\u4E2A\\u65B9\\u6CD5\\u4F1A\\u5728\\u54EA\\u91CC\\u8C03\\u7528\\u53EF\\u4EE5\\u770B\\u4E0A\\u4E00\\u7BC7\\uFF0C\\u6709\\u5177\\u4F53\\u7684\\u8BB2\\u89E3\\u548C\\u4EE3\\u7801\\uFF0CFragment \\u5C31\\u662F\\u76F4\\u63A5\\u5C06\\u5B50\\u8282\\u70B9\\u8FDB\\u884C\\u6E32\\u67D3\\uFF0C\\u672C\\u8EAB\\u53EF\\u4EE5\\u7528\\u4E24\\u4E2A placeholder \\u6765\\u6807\\u8BB0\\u5934\\u90E8\\u548C\\u5C3E\\u90E8\\uFF0C\\u56E0\\u4E3A Fragment \\u7684 nextSibling \\u662F\\u5C3E\\u90E8 placehoder \\u7684 nextSibling\\uFF0C\\u800C getNode \\u7528\\u4E8E\\u63D2\\u5165\\u5230 Fragment \\u524D\\u9762\\uFF0C\\u6240\\u4EE5\\u8FD4\\u56DE\\u7684\\u662F Fragment \\u7684\\u5934\\u90E8 placeholder\"), mdx(\"h2\", {\n    \"id\": \"teleport\"\n  }, \"Teleport\"), mdx(\"p\", null, \"Teleport \\u5F88\\u50CF Fragment\\uFF0C\\u552F\\u4E00\\u7684\\u4E0D\\u540C\\u5C31\\u662F Teleport \\u628A\\u5B50\\u8282\\u70B9\\u6E32\\u67D3\\u5230 target \\u8282\\u70B9\\u4E0A\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-js:title=runtime-core/components/teleport.js\",\n    \"metastring\": \"{11-13,17,20-26}\",\n    \"{11-13,17,20-26}\": true\n  }), \"export const Teleport = {\\n  patch(\\n    { renderOptions, mountChildren, patchChildren, move },\\n    { n1, n2, container, isSVG, anchor },\\n  ) {\\n    if (n1 == null) {\\n      const teleportStartAnchor = n2.node = renderOptions.createText('')\\n      const teleportEndAnchor = n2.anchor = renderOptions.createText('')\\n      renderOptions.insert(teleportStartAnchor, container, anchor)\\n      renderOptions.insert(teleportEndAnchor, container, anchor)\\n      const target = renderOptions.querySelector(n2.props.to)\\n      n2.target = target\\n      mountChildren(n2, target, isSVG, null)\\n    } else {\\n      n2.node = n1.node\\n      n2.anchor = n1.anchor\\n      n2.target = n1.target\\n      patchChildren(n1, n2, n2.target, isSVG)\\n\\n      if (n1.props.to !== n2.props.to) {\\n        const target = renderOptions.querySelector(n2.props.to)\\n        n2.target = target\\n        for (let child of n2.children) {\\n          move(child, container, null)\\n        }\\n      }\\n    }\\n  },\\n\\n  getNode(internals, { vnode }) {\\n    return vnode.node\\n  },\\n\\n  getNextSibling({ renderOptions }, { vnode }) {\\n    return renderOptions.nextSibling(vnode.anchor)\\n  },\\n\\n  move({ renderOptions, move }, { vnode, container, anchor }) {\\n    const { insert: hostInsert } = renderOptions\\n    const teleportStartAnchor = vnode.node\\n    const teleportEndAnchor = vnode.anchor\\n    hostInsert(teleportStartAnchor, container, anchor)\\n    hostInsert(teleportEndAnchor, container, anchor)\\n  },\\n\\n  unmount({ renderOptions, unmount }, { vnode }) {\\n    const { remove: hostRemove } = renderOptions\\n    hostRemove(vnode.node)\\n    vnode.children.forEach(c => unmount(c))\\n    hostRemove(vnode.anchor)\\n  },\\n}\\n\")), mdx(\"p\", null, \"\\u4E0D\\u540C\\u4E8E ReactDOM.createProtal \\u7531\\u4E8E ReactDOM \\u6709\\u4E00\\u4E2A\\u4E8B\\u4EF6\\u7684\\u5408\\u6210\\u5C42\\uFF0C\\u53EF\\u4EE5\\u5728\\u8FD9\\u91CC\\u505A\\u4E00\\u4E9B hack\\uFF0C\\u4F7F Portal \\u7684\\u7236\\u7EC4\\u4EF6\\u53EF\\u4EE5\\u6355\\u6349\\u5230 Portal \\u4E2D\\u7684\\u4E8B\\u4EF6\\uFF0CVue3\\u3001Preact \\u7531\\u4E8E\\u6CA1\\u6709\\u5B9E\\u73B0\\u4E8B\\u4EF6\\u5408\\u6210\\u5C42\\uFF0C\\u6240\\u4EE5\\u7236\\u7EC4\\u4EF6\\u4E0D\\u80FD\\u6355\\u6349\\u5230 Teleport \\u4E2D\\u7684\\u4E8B\\u4EF6\\uFF0C\\u4F46\\u76F8\\u5E94\\u7684\\u51CF\\u5C11\\u4E86\\u5F88\\u591A\\u7684\\u4EE3\\u7801\\u91CF\\uFF0C\\u5305\\u7684\\u4F53\\u79EF\\u51CF\\u5C0F\\u5F88\\u591A\"), mdx(\"h2\", {\n    \"id\": \"inject--provide\"\n  }, \"Inject / Provide\"), mdx(\"p\", null, \"\\u76F4\\u63A5\\u770B\\u5B9E\\u73B0\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-js:title=runtime-core/inject.js\",\n    \"metastring\": \"{12,14,23}\",\n    \"{12,14,23}\": true\n  }), \"import { isFunction } from '../shared'\\nimport { getCurrentInstance } from './component'\\n\\nexport const provide = (key, value) => {\\n  const currentInstance = getCurrentInstance()\\n  if (!currentInstance) {\\n    console.warn(`provide() can only be used inside setup().`)\\n  } else {\\n    let { provides } = currentInstance\\n    const parentProvides = currentInstance.parent && currentInstance.parent.provides\\n    if (parentProvides === provides) {\\n      provides = currentInstance.provides = Object.create(parentProvides)\\n    }\\n    provides[key] = value\\n  }\\n}\\n\\nexport const inject = (key, defaultValue) => {\\n  const currentInstance = getCurrentInstance()\\n  if (currentInstance) {\\n    const { provides } = currentInstance\\n    if (key in provides) {\\n      return provides[key]\\n    } else if (arguments.length > 1) { // defaultValue \\u53EF\\u4EE5\\u4F20\\u5165 undefined\\n      return isFunction(defaultValue)\\n        ? defaultValue()\\n        : defaultValue\\n    } else {\\n      console.warn(`injection \\\"${String(key)}\\\" not found.`)\\n    }\\n  } else {\\n    console.warn(`inject() can only be used inside setup() or functional components.`)\\n  }\\n}\\n\")), mdx(\"p\", null, \"\\u53EF\\u4EE5\\u770B\\u51FA\\u6765 provides \\u662F\\u653E\\u5728 instance \\u4E0A\\u7684\\uFF0C\\u6BCF\\u4E2A instance \\u7684 provides \\u90FD\\u662F\\u901A\\u8FC7 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Object.create\"), \" \\u7EE7\\u627F parentInstance \\u7684 provides\"), mdx(\"p\", null, \"provide \\u8C03\\u7528\\u65F6\\u5C31\\u662F\\u62FF\\u5230 currentInstance\\uFF0C\\u7136\\u540E\\u7EE7\\u627F currentInstance.parent \\u7684 provides\\uFF0C\\u518D\\u50CF\\u4E0A\\u9762\\u901A\\u8FC7 key \\u6DFB\\u52A0\\u5C5E\\u6027\\uFF1Binject \\u5C31\\u662F\\u62FF\\u5230 currentInstance \\u7684 provides\\uFF0C\\u518D\\u901A\\u8FC7 key \\u53D6\\u503C\\u5373\\u53EF\\uFF0C\\u6BD4\\u8F83\\u5DE7\\u5999\\u7684\\u5C31\\u662F defaultValue \\u5BF9\\u4E8E undefined \\u7684\\u5904\\u7406\"), mdx(\"p\", null, \"\\u4E4B\\u524D\\u6211\\u4EEC\\u7684 runtime \\u5E76\\u6CA1\\u6709\\u518D instance \\u4E0A\\u653E provides \\u5C5E\\u6027\\uFF0C\\u800C\\u4E14\\u600E\\u6837\\u53BB\\u62FF parentInstance\\uFF0C\\u63A5\\u4E0B\\u6765\\u6211\\u4EEC\\u4FEE\\u6539\\u4E4B\\u524D\\u5199\\u7684 runtime\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-js:title=runtime-core/renderer.js\",\n    \"metastring\": \"{8,9}\",\n    \"{8,9}\": true\n  }), \"const processComponent = (n1, n2, container, isSVG, anchor) => {\\n  if (n1 == null) {\\n    const instance = n2.instance = {\\n      // ...\\n      parent: null,\\n      provides: null,\\n    }\\n    const parentInstance = instance.parent = getParentInstance(n2)\\n    instance.provides = parentInstance ? parentInstance.provides : Object.create(null) // \\u6CA1\\u6709 parentInstance \\u8BF4\\u660E\\u662F\\u6839\\u7EC4\\u4EF6\\uFF0C\\u5B83\\u7684 provides \\u6211\\u4EEC\\u521D\\u59CB\\u5316\\u6210\\u7A7A\\u5BF9\\u8C61\\n  } // ...\\n}\\n\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-js:title=runtime/component.js\",\n    \"metastring\": \"{4}\",\n    \"{4}\": true\n  }), \"export const getParentInstance = (vnode) => {\\n  let parentVNode = vnode.parent\\n  while (parentVNode != null) {\\n    if (parentVNode.instance != null) return parentVNode.instance\\n    parentVNode = parentVNode.parent\\n  }\\n  return null\\n}\\n\")), mdx(\"p\", null, \"\\u6E90\\u7801\\u4E2D parentInstance \\u662F\\u7C7B\\u4F3C\\u4E8E anchor \\u4F5C\\u4E3A\\u4E00\\u4E2A\\u53C2\\u6570\\u4E00\\u5C42\\u4E00\\u5C42\\u4F20\\u4E0B\\u6765\\u7684\\uFF0C\\u4E4B\\u540E\\u7684 parentSuspense \\u4E5F\\u662F\\uFF0C\\u6211\\u4EEC\\u8FD9\\u91CC\\u5C3D\\u91CF\\u7B80\\u5316\\uFF0C\\u901A\\u8FC7\\u5224\\u65AD \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \".parent\"), \" \\u94FE\\u4E2D\\u662F\\u5426\\u6709 instance \\u8FDB\\u884C\\u67E5\\u627E\"), mdx(\"h2\", {\n    \"id\": \"onerrorcaptured\"\n  }, \"onErrorCaptured\"), mdx(\"p\", null, \"\\u6211\\u4EEC\\u6765\\u5B9E\\u73B0\\u6211\\u4EEC\\u552F\\u4E00\\u6CA1\\u6709\\u780D\\u6389\\u7684\\u94A9\\u5B50\\u2026\\u2026\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-js:title=runtime-core/error-handling.js\",\n    \"metastring\": \"{8,16,28}\",\n    \"{8,16,28}\": true\n  }), \"import { getCurrentInstance } from './component'\\n\\nexport const onErrorCaptured = (errorHandler) => {\\n  const instance = getCurrentInstance()\\n  if (instance.errorCapturedHooks == null) { // \\u8FD9\\u6837\\u4E0D\\u7528\\u4FEE\\u6539 renderer \\u4E2D\\u7684\\u4EE3\\u7801\\u4E86\\n    instance.errorCapturedHooks = []\\n  }\\n  instance.errorCapturedHooks.push(errorHandler)\\n}\\n\\nexport const callWithErrorHandling = (fn, instance, args = []) => {\\n  let res\\n  try {\\n    res = fn(...args)\\n  } catch (e) {\\n    handleError(e, instance)\\n  }\\n  return res\\n}\\n\\nexport const handleError = (error, instance) => {\\n  if (instance) {\\n    let cur = instance.parent\\n    while (cur) {\\n      const errorCapturedHooks = cur.errorCapturedHooks\\n      if (errorCapturedHooks) {\\n        for (let errorHandler of errorCapturedHooks) {\\n          if (errorHandler(error)) {\\n            return\\n          }\\n        }\\n      }\\n      cur = cur.parent\\n    }\\n  }\\n  console.warn('Unhandled error', error)\\n}\\n\")), mdx(\"p\", null, \"onErrorCaptured \\u5C31\\u662F\\u6DFB\\u52A0\\u9519\\u8BEF\\u5904\\u7406\\u7684\\u51FD\\u6570\\uFF0C\\u901A\\u8FC7 handleError \\u6765\\u4ECE \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"instance.parent\"), \" \\u4E2D\\u8C03\\u7528\\u8FD9\\u4E9B\\u51FD\\u6570\\uFF0C\\u77E5\\u9053\\u8FD4\\u56DE true \\u4E3A\\u6B62\\uFF0C\\u800C callWithErrorHandling \\u662F\\u7528\\u6765\\u89E6\\u53D1 handleError \\u7684\\uFF0C\\u6211\\u4EEC\\u5BF9\\u4E8E\\u7528\\u6237\\u53EF\\u80FD\\u51FA\\u9519\\u7684\\u5730\\u65B9\\uFF08\\u53EF\\u80FD\\u6709\\u526F\\u4F5C\\u7528\\u7684\\u5730\\u65B9\\uFF09\\u8C03\\u7528\\u65F6\\u5305\\u88F9\\u4E00\\u5C42 callWithErrorHandling \\u5373\\u53EF\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-js:title=runtime-core/api-watch.js\",\n    \"metastring\": \"{4,10}\",\n    \"{4,10}\": true\n  }), \"export const watchEffect = (cb, { onTrack, onTrigger } = {}) => {\\n  let cleanup\\n  const onInvalidate = (fn) => {\\n    cleanup = e.options.onStop = () => callWithErrorHandling(fn, instance)\\n  }\\n  const getter = () => {\\n    if (cleanup) {\\n      cleanup()\\n    }\\n    return callWithErrorHandling(cb, instance, [onInvalidate])\\n  }\\n  // ...\\n}\\n\")), mdx(\"h2\", {\n    \"id\": \"suspense\"\n  }, \"Suspense\"), mdx(\"p\", null, \"Vue3 \\u5728\\u66F4\\u65B0\\u65F6\\u9047\\u5230 Suspense \\u662F\\u5728\\u5185\\u5B58\\u4E2D\\u521B\\u5EFA\\u4E00\\u4E2A hiddenContianer\\uFF0C\\u5728\\u5185\\u5B58\\u4E2D\\u7EE7\\u7EED\\u6E32\\u67D3 children\\uFF0C\\u6E32\\u67D3 children \\u65F6\\u5982\\u679C\\u9047\\u5230 async setup \\u4F1A\\u9690\\u5F0F\\u7684\\u8FD4\\u56DE\\u4E00\\u4E2A Promise\\uFF0CSuspense \\u901A\\u8FC7 register \\u63A5\\u6536\\u8FD9\\u4E2A Promise\\uFF0C\\u6E32\\u67D3\\u5B8C children \\u540E\\u5224\\u65AD\\u662F\\u5426\\u6709\\u63A5\\u6536 Promise\\uFF0C\\u5982\\u679C\\u6CA1\\u6709\\u5219\\u628A hiddenContainer \\u4E2D\\u7684 children \\u79FB\\u52A8\\u5230 container \\u4E2D\\uFF0C\\u6709\\u5219\\u6E32\\u67D3 fallback \\u4F5C\\u4E3A\\u5B50\\u8282\\u70B9\\uFF0C\\u4E4B\\u540E\\u6240\\u6709\\u63A5\\u6536\\u5230\\u7684 Promise \\u5728 resolve \\u4E4B\\u540E\\u518D\\u628A hiddenContainer \\u4E2D\\u7684 children \\u79FB\\u52A8\\u5230 container \\u4E2D\"), mdx(\"p\", null, \"\\u5728\\u5185\\u5B58\\u4E2D\\u521B\\u5EFA hiddenContainer \\u53BB\\u6E32\\u67D3 children \\u662F\\u56E0\\u4E3A Suspense \\u5FC5\\u987B\\u8981\\u6839\\u636E\\u662F\\u5426\\u6709\\u63A5\\u6536\\u5230 Promise \\u5224\\u65AD\\u6E32\\u67D3 fallback \\u8FD8\\u662F children\\uFF0C\\u800C Promise \\u53EA\\u6765\\u81EA\\u6267\\u884C children \\u4E2D\\u7684 async setup\"), mdx(\"p\", null, \"Suspense \\u7684\\u5904\\u7406\\u4E3B\\u8981\\u5206\\u4E3A\\u4E24\\u90E8\\u5206\\uFF0C\\u4E00\\u90E8\\u5206\\u662F Suspense \\u672C\\u8EAB\\u7684\\u5904\\u7406\\uFF0C\\u53E6\\u4E00\\u90E8\\u5206\\u662F\\u5BF9 async setup \\u5B50\\u7EC4\\u4EF6\\u7684\\u5904\\u7406\\uFF0C\\u9996\\u5148\\u6765\\u770B Suspense \\u672C\\u8EAB\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-js:title=runtime-core/components/suspense.js\",\n    \"metastring\": \"{3,9-11,26-28}\",\n    \"{3,9-11,26-28}\": true\n  }), \"const createSuspense = (vnode, container, isSVG, anchor, internals, hiddenContainer) => {\\n  const suspense = {\\n    deps: [],\\n    container,\\n    anchor,\\n    isSVG,\\n    hiddenContainer,\\n    resolve() {\\n      internals.unmount(vnode.props.fallback)\\n      internals.move(vnode.props.children, suspense.container, suspense.anchor)\\n      vnode.node = internals.getNode(vnode.props.children)\\n    },\\n    register(instance, setupRenderEffect) {\\n      // ...\\n    },\\n  }\\n  return suspense\\n}\\n\\nexport const Suspense = {\\n  patch(\\n    internals,\\n    { n1, n2, container, isSVG, anchor },\\n  ) {\\n    if (n1 == null) {\\n      const hiddenContainer = internals.renderOptions.createElement('div')\\n      const suspense = n2.suspense = createSuspense(n2, container, isSVG, anchor, internals, hiddenContainer)\\n      internals.mountChildren(n2, hiddenContainer, isSVG, null)\\n      internals.patch(null, n2.props.fallback, container, isSVG, anchor)\\n      n2.node = internals.getNode(n2.props.fallback)\\n      if (suspense.deps.length === 0) {\\n        suspense.resolve()\\n      }\\n    } else {\\n      // patchSuspense\\n    }\\n  },\\n\\n  getNode(internals, { vnode }) {\\n    return vnode.node\\n  },\\n\\n  getNextSibling({ renderOptions }, { vnode }) {\\n    return renderOptions.nextSibling(vnode.node)\\n  },\\n\\n  move({ move }, { vnode, container, anchor }) {\\n    if (vnode.suspense.deps.length) {\\n      move(vnode.props.fallback, container, anchor)\\n    } else {\\n      move(vnode.props.children, container, anchor)\\n    }\\n    vnode.suspense.container = container\\n    vnode.suspense.anchor = anchor\\n  },\\n\\n  unmount({ unmount }, { vnode, doRemove }) {\\n    if (vnode.suspense.deps.length) {\\n      unmount(vnode.props.fallback, doRemove)\\n    } else {\\n      unmount(vnode.props.children, doRemove)\\n    }\\n  },\\n}\\n\\nexport const getParentSuspense = (vnode) => {\\n  vnode = vnode.parent\\n  while (vnode) {\\n    if (vnode.type === Suspense) return vnode.suspense\\n    vnode = vnode.parent\\n  }\\n  return null\\n}\\n\")), mdx(\"p\", null, \"\\u6211\\u4EEC\\u5B9E\\u73B0\\u7684\\u5F88\\u7B80\\u964B\\uFF0C\\u53EF\\u4EE5\\u770B\\u5230\\u6838\\u5FC3\\u903B\\u8F91\\u5C31\\u662F\\u521B\\u5EFA\\u4E00\\u4E2A hiddenContainer\\uFF0C\\u5728\\u8FD9\\u91CC\\u9762\\u6E32\\u67D3 children\\uFF0C\\u7136\\u540E createSuspense \\u521B\\u5EFA\\u5B9E\\u4F8B\\uFF0Cresolve \\u7684\\u65F6\\u5019\\u5C31\\u662F\\u628A fallback unmount \\u6389\\u518D\\u628A hiddContainer \\u4E2D\\u7684\\u79FB\\u52A8\\u5230 container \\u4E2D\\uFF0Cmove \\u7684\\u65F6\\u5019 container \\u548C anchor \\u4F1A\\u6539\\u53D8\\uFF0C\\u4F1A\\u5F71\\u54CD resolve\\uFF0C\\u6240\\u4EE5 suspense \\u5B9E\\u4F8B\\u7684\\u5C5E\\u6027\\u4E5F\\u8981\\u8FDB\\u884C\\u4FEE\\u6539\\uFF0C\\u8FD9\\u65F6\\u8FD8\\u6709\\u5F88\\u91CD\\u8981\\u7684\\u4E00\\u90E8\\u5206 patchSuspense\\uFF0C\\u4F46\\u662F\\u8DDF\\u539F\\u7406\\u76F8\\u5173\\u6027\\u8F83\\u5C0F\\uFF0C\\u5C31\\u4E0D\\u5199\\u4E86\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-js:title=runtime-core/renderer.js\",\n    \"metastring\": \"{5-16}\",\n    \"{5-16}\": true\n  }), \"const processComponent = (n1, n2, container, isSVG, anchor) => {\\n  if (n1 == null) {\\n    // ...\\n    if (isPromise(render)) {\\n      const suspense = getParentSuspense(n2)\\n      const placeholder = instance.subTree = h(TextType, { nodeValue: '' })\\n      patch(null, placeholder, container, anchor)\\n      suspense.register(\\n        instance,\\n        () => setupRenderEffect(\\n          instance,\\n          internals.renderOptions.parentNode(instance.subTree.node),\\n          isSVG,\\n          internals.renderOptions.nextSibling(instance.subTree.node),\\n        ),\\n      )\\n    } else if (isFunction(render)) {\\n      setupRenderEffect(instance, container, isSVG, anchor)\\n    } else {\\n      console.warn('setup component: ', n2.type, ' need to return a render function')\\n    }\\n\\n    function setupRenderEffect(instance, container, isSVG, anchor) {\\n      instance.update = effect(() => { // component update \\u7684\\u5165\\u53E3\\n        const renderResult = instance.render()\\n        const vnode = instance.vnode\\n        vnode.children = [renderResult]\\n        renderResult.parent = vnode\\n        patch(instance.subTree, renderResult, container, isSVG, anchor)\\n        instance.subTree = renderResult\\n      }, {\\n        scheduler: queueJob,\\n      })\\n    }\\n  } // ...\\n}\\n\")), mdx(\"p\", null, \"\\u63A5\\u4E0B\\u6765\\u5BF9\\u4E8E async setup \\u5B50\\u7EC4\\u4EF6\\u7684\\u5904\\u7406\\u5C31\\u8981\\u4FEE\\u6539 runtime \\u4E86\\uFF0C\\u6211\\u4EEC\\u5BF9 setup \\u8FD4\\u56DE\\u7ED3\\u679C\\u8FDB\\u884C\\u5224\\u65AD\\uFF0C\\u5982\\u679C\\u662F Promise \\u5C31\\u627E\\u5230 parentSuspense \\u8FDB\\u884C\\u6CE8\\u518C\\uFF0C\\u8FD9\\u91CC\\u6211\\u4EEC\\u62BD\\u79BB setupRenderEffect\\uFF0C\\u6CE8\\u518C\\u65F6\\u4F20\\u5165\\u4E00\\u4E2A\\u56DE\\u8C03\\u51FD\\u6570\\uFF0C\\u7528\\u4E8E suspense resolve \\u65F6\\u7EE7\\u7EED\\u6E32\\u67D3\\u8BE5\\u5B50\\u7EC4\\u4EF6\\u4F7F\\u7528\\uFF0C\\u540C\\u65F6\\u521B\\u5EFA\\u4E00\\u4E2A placeholder \\u7ED9\\u7EC4\\u4EF6\\u7AD9\\u4F4D\\uFF0C\\u7528\\u4EE5 setupRenderEffect \\u4E2D\\u83B7\\u53D6 container \\u548C anchor\\uFF0C\\u56E0\\u4E3A async setup \\u7EC4\\u4EF6\\u5728\\u6CA1\\u6709 resolve \\u65F6\\u53EF\\u80FD\\u6709\\u65B0\\u7684\\u8282\\u70B9\\u63D2\\u5165\\uFF0C\\u5982\\u679C container\\u3001anchor \\u8FD8\\u662F\\u65E7\\u7684\\u503C\\u65F6\\u53EF\\u80FD\\u4F1A\\u51FA\\u9519\\uFF08anchor \\u4E3A null\\uFF0C\\u4F46\\u662F\\u4E4B\\u540E\\u63D2\\u5165\\u4E86\\u8282\\u70B9\\uFF0Cresolve \\u65F6 anchor \\u8FD8\\u662F null \\u7684\\u8BDD\\u5C31\\u5BFC\\u81F4\\u8282\\u70B9\\u987A\\u5E8F\\u9519\\u8BEF\\uFF09\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-js:title=runtime-core/components/suspense.js\",\n    \"metastring\": \"{6,9,12-18}\",\n    \"{6,9,12-18}\": true\n  }), \"const createSuspense = (vnode, container, isSVG, anchor, internals, hiddenContainer) => {\\n  const suspense = {\\n    deps: [],\\n    // ...\\n    register(instance, setupRenderEffect) {\\n      suspense.deps.push(instance)\\n      instance.render\\n        .catch(e => {\\n          handleError(e, instance)\\n        })\\n        .then(renderFn => {\\n          instance.render = renderFn\\n          setupRenderEffect()\\n          const index = suspense.deps.indexOf(instance)\\n          suspense.deps.splice(index, 1)\\n          if (suspense.deps.length === 0) {\\n            suspense.resolve()\\n          }\\n        })\\n    },\\n  }\\n  return suspense\\n}\\n\")), mdx(\"p\", null, \"\\u7136\\u540E register \\u5C31\\u662F\\u5C06 async setup \\u7EC4\\u4EF6\\u5B9E\\u4F8B\\u52A0\\u5165\\u5230 suspense.deps \\u4E2D\\uFF0C\\u7136\\u540E\\u7B49 render resolve \\u65F6\\u8C03\\u7528 setupRenderEffect \\u6E32\\u67D3\\u8BE5\\u7EC4\\u4EF6\\uFF0C\\u5E76\\u5224\\u65AD\\u662F\\u5426\\u53EF\\u4EE5 resolve \\u4E86\\uFF0C\\u8FD9\\u91CC catch \\u540E handleError \\u662F\\u56E0\\u4E3A async setup \\u53EF\\u4EE5\\u6267\\u884C\\u526F\\u4F5C\\u7528\\uFF0C\\u53EF\\u80FD\\u4F1A\\u51FA\\u9519\"), mdx(\"h2\", {\n    \"id\": \"defineasynccomponent\"\n  }, \"defineAsyncComponent\"), mdx(\"p\", null, \"\\u662F\\u4E00\\u4E2A\\u9AD8\\u9636\\u7EC4\\u4EF6\\uFF0C\\u76F8\\u5F53\\u4E8E\\u4E00\\u4E2A\\u589E\\u5F3A\\u7248\\u7684 lazy\\uFF0C\\u5F53\\u5B83\\u7684\\u4E0A\\u5C42\\u6709 Suspense \\u65F6\\uFF0C\\u5C31\\u8FD4\\u56DE\\u4E00\\u4E2A Promise\\uFF0C\\u5426\\u5219\\u8FD4\\u56DE\\u76F8\\u5E94\\u72B6\\u6001\\u7684\\u7EC4\\u4EF6\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-js:title=runtime-core/api-define-component.js\",\n    \"metastring\": \"{35-39,48,52}\",\n    \"{35-39,48,52}\": true\n  }), \"export const defineAsyncComponent = (options) => {\\n  if (isFunction(options)) options = { loader: options }\\n\\n  const {\\n    loader,\\n    errorComponent,\\n    suspensible = true,\\n    onError,\\n  } = options\\n\\n  let resolvedComponent = null\\n\\n  let retries = 0\\n  const retry = () => {\\n    retries++\\n    return load()\\n  }\\n\\n  const load = () => loader()\\n    .catch(e => {\\n      if (onError) {\\n        return new Promise((resolve, reject) => {\\n          onError(\\n            e,\\n            () => resolve(retry()),\\n            () => reject(e),\\n            retries,\\n          )\\n        })\\n      } else {\\n        throw e\\n      }\\n    })\\n    .then((comp) => {\\n      if (comp && (comp.__esModule || comp[Symbol.toStringTag] === 'Module')) {\\n        comp = comp.default\\n      }\\n      resolvedComponent = comp\\n      return comp\\n    })\\n\\n  return defineComponent((props) => {\\n    const instance = getCurrentInstance()\\n    if (resolvedComponent) return () => h(resolvedComponent, props)\\n    if (suspensible && getParentSuspense(instance.vnode)) {\\n      return load()\\n        .then(comp => {\\n          return () => h(comp, props)\\n        })\\n        .catch(e => {\\n          handleError(e, instance)\\n          return () => errorComponent ? h(errorComponent, { error: e }) : null\\n        })\\n    }\\n  })\\n}\\n\")), mdx(\"p\", null, \"\\u5148\\u6765\\u770B\\u6709 Suspense \\u7684\\u60C5\\u51B5\\uFF0C\\u7C7B\\u4F3C\\u4E8E lazy \\u7684\\u5B9E\\u73B0\\uFF0C\\u4F5C\\u4E3A\\u4E00\\u4E2A\\u9AD8\\u9636\\u7EC4\\u4EF6\\u8FD4\\u56DE Promise\\uFF0C\\u5728\\u51FA\\u9519\\u7684\\u65F6\\u5019\\u5982\\u679C\\u6709 onError \\u5C31\\u901A\\u8FC7 onError \\u4EA4\\u7ED9\\u7528\\u6237\\u5904\\u7406\\uFF0C\\u6CA1\\u6709\\u5C31\\u7EE7\\u7EED\\u629B\\u51FA error\\uFF0C\\u540E\\u9762 catch \\u4F4F\\u6E32\\u67D3 errorComponent\"), mdx(\"p\", null, \"\\u518D\\u8865\\u4E0A\\u6CA1\\u6709 Suspense \\u7684\\u60C5\\u51B5\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-js:title=runtime-core/api-define-component.js\",\n    \"metastring\": \"{7-9,23,26-33,44-48}\",\n    \"{7-9,23,26-33,44-48}\": true\n  }), \"export const defineAsyncComponent = (options) => {\\n  if (isFunction(options)) options = { loader: options }\\n\\n  const {\\n    loader,\\n    loadingComponent,\\n    errorComponent,\\n    delay = 200,\\n    timeout,\\n    suspensible = true,\\n    onError,\\n  } = options\\n  // ...\\n\\n  return defineComponent((props) => {\\n    // ...\\n\\n    const error = ref()\\n    const loading = ref(true)\\n    const delaying = ref(!!delay) // \\u5EF6\\u540E\\u51FA\\u73B0 LoadingComponent\\n\\n    if (delay) {\\n      setTimeout(() => delaying.value = false, delay)\\n    }\\n    if (timeout) {\\n      setTimeout(() => {\\n        // \\u8D85\\u65F6\\n        if (loading.value && !error.value) {\\n          const err = new Error(`Async component timed out after ${timeout}ms.`)\\n          handleError(err, instance)\\n          error.value = err\\n        }\\n      }, timeout)\\n    }\\n\\n    load()\\n      .then(() => loading.value = false)\\n      .catch(e => {\\n        handleError(e, instance)\\n        error.value = e\\n      })\\n\\n    return () => {\\n      if (!loading.value && resolvedComponent) return h(resolvedComponent, props)\\n      // loading.value === true\\n      else if (error.value && errorComponent) return h(errorComponent, { error: error.value })\\n      else if (loadingComponent && !delaying.value) return h(loadingComponent)\\n      return null\\n    }\\n  })\\n}\\n\")), mdx(\"p\", null, \"\\u8FD9\\u91CC\\u901A\\u8FC7\\u5224\\u65AD suspensible \\u4E3A false \\u6216\\u8005\\u6CA1\\u6709 parentSuspense \\u8FD4\\u56DE render function\\uFF0C\\u6839\\u636E\\u76F8\\u5E94\\u7684\\u72B6\\u6001\\u6E32\\u67D3\\u76F8\\u5E94\\u7684\\u7EC4\\u4EF6\\uFF0Cdelay \\u8FD9\\u4E2A\\u53C2\\u6570\\u7684\\u4F5C\\u7528\\u662F\\u4E3A\\u4E86 delay \\u51FA\\u73B0 loadingComponent \\u7684\\uFF0C\\u5982\\u679C\\u52A0\\u8F7D\\u6BD4\\u8F83\\u5FEB\\u5C31\\u4E0D\\u7528\\u5C55\\u793A loading\"), mdx(\"p\", null, \"\\u6211\\u4EEC\\u76EE\\u524D\\u5199\\u7684\\u4E0D\\u80FD\\u5B9E\\u73B0\\u7684\\u4E00\\u79CD\\u60C5\\u51B5\\u662F suspensible \\u4E3A false \\u4F46\\u662F\\u6709 parentSuspense\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-jsx\"\n  }), \"const ProfileDetails = defineAsyncComponent({\\n  loader: () => import('./async.jsx'),\\n  loadingComponent: defineComponent(() => () => <h1>Loading...</h1>),\\n  suspensible: false,\\n});\\n\\nconst App = {\\n  setup(props) {\\n    return () => (\\n      <Suspense fallback={<h1>Loading by Suspense</h1>}>\\n        <ProfileDetails />\\n      </Suspense>\\n    );\\n  },\\n};\\n\")), mdx(\"p\", null, \"\\u8FD9\\u662F\\u56E0\\u4E3A setupRenderEffect \\u4F20\\u5165\\u7684 container\\u3001anchor \\u662F\\u4E0D\\u53D8\\u7684\\uFF0C\\u901A\\u8FC7\\u95ED\\u5305\\u5B58\\u8D77\\u6765\\u4E86\\uFF0CProfileDetails \\u4E00\\u5F00\\u59CB\\u6E32\\u67D3\\u65F6\\u662F\\u5728 Suspense \\u4E2D\\u7684\\uFF0C\\u5B83\\u7684 container \\u662F hiddenContainer\\uFF0C\\u4E4B\\u540E\\u6E32\\u67D3\\u4E5F\\u662F hiddenContainer\\uFF0C\\u6240\\u4EE5\\u5BFC\\u81F4\\u9875\\u9762\\u7A7A\\u767D\\uFF0C\\u6211\\u4EEC\\u53EF\\u4EE5\\u628A container\\u3001anchor \\u653E\\u5230 instance \\u5B9E\\u4F8B\\u4E0A\\uFF0C\\u8BA9\\u8FD9\\u4E24\\u4E2A\\u503C\\u53EF\\u4EE5\\u6539\\u53D8\\uFF0C\\u901A\\u8FC7 instance \\u4E0A\\u7684 container\\u3001anchor \\u8FDB\\u884C\\u6E32\\u67D3\"), mdx(\"h2\", {\n    \"id\": \"keepalive\"\n  }, \"KeepAlive\"), mdx(\"p\", null, \"\\u5EFA\\u7ACB\\u4E00\\u4E2A Map \\u4F5C\\u4E3A\\u7F13\\u5B58\\uFF0C\\u4EE5\\u5B50\\u8282\\u70B9\\u7684 key \\u6216 type \\u4F5C\\u4E3A\\u7F13\\u5B58\\u7684 key\\uFF08\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"const key = vnode.key == null ? vnode.type : vnode.key\"), \"\\uFF09\\uFF1BKeepAlive \\u7684 render function \\u88AB\\u8C03\\u7528\\u65F6\\uFF0C\\u4E5F\\u5C31\\u662F KeepAlive \\u88AB\\u6E32\\u67D3\\u65F6\\uFF0C\\u4F1A\\u6839\\u636E props \\u7684 includes \\u548C excludes \\u89C4\\u5219\\u5224\\u65AD children \\u662F\\u5426\\u53EF\\u4EE5\\u88AB\\u7F13\\u5B58\\uFF0C\\u4E0D\\u53EF\\u4EE5\\u5C31\\u76F4\\u63A5\\u6E32\\u67D3\\uFF0C\\u53EF\\u4EE5\\u5C31\\u5728\\u7F13\\u5B58\\u91CC\\u627E\\uFF0C\\u5982\\u679C\\u7F13\\u5B58\\u91CC\\u6709\\u5C31\\u7528\\u7F13\\u5B58\\u4E2D\\u7684\\u8FDB\\u884C\\u6E32\\u67D3\\uFF0Cchildren \\u7684\\u72B6\\u6001\\u90FD\\u662F\\u65E7\\u7684\\u5728\\u7F13\\u5B58\\u4E2D\\u7684\\uFF0C\\u5426\\u5219\\u7528\\u65B0\\u7684 children \\u5E76\\u8FDB\\u884C\\u7F13\\u5B58\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-js\",\n    \"metastring\": \"{11-13,17-19}\",\n    \"{11-13,17-19}\": true\n  }), \"if (cachedVNode) {\\n  // copy over mounted state\\n  vnode.el = cachedVNode.el\\n  vnode.component = cachedVNode.component\\n  if (vnode.transition) {\\n    // recursively update transition hooks on subTree\\n    setTransitionHooks(vnode, vnode.transition!)\\n  }\\n  // avoid vnode being mounted as fresh\\n  vnode.shapeFlag |= ShapeFlags.COMPONENT_KEPT_ALIVE\\n  // make this key the freshest\\n  keys.delete(key)\\n  keys.add(key)\\n} else {\\n  keys.add(key)\\n  // prune oldest entry\\n  if (max && keys.size > parseInt(max as string, 10)) {\\n    pruneCacheEntry(keys.values().next().value)\\n  }\\n}\\n\")), mdx(\"p\", null, \"\\u6E90\\u7801\\u4E2D KeepAlive \\u7684\\u7F13\\u5B58\\u7528\\u5230\\u4E86 LRU \\u7B97\\u6CD5\\uFF0Ckeys \\u662F\\u4E00\\u4E2A Set\\uFF0C\\u53EF\\u4EE5\\u770B\\u5230\\u6BCF\\u6B21\\u4F7F\\u7528\\u7F13\\u5B58\\u65F6\\u4F1A\\u5237\\u65B0\\u4E00\\u4E0B\\u7F13\\u5B58\\uFF0C\\u53D8\\u6210\\u65B0\\u9C9C\\u7684\\uFF0C\\u5982\\u679C\\u518D\\u6765\\u65B0\\u7F13\\u5B58\\u65F6\\uFF0C\\u7F13\\u5B58\\u8D85\\u8FC7\\u4E86 max\\uFF0C\\u5C31\\u5220\\u53BB\\u6700\\u9648\\u65E7\\u7684\\u7F13\\u5B58\\uFF0C\\u5229\\u7528 Set \\u5BF9 LRU \\u8FDB\\u884C\\u4E86\\u7B80\\u6613\\u7684\\u5B9E\\u73B0\"), mdx(\"h2\", {\n    \"id\": \"transition\"\n  }, \"Transition\"), mdx(\"p\", null, \"Transition \\u662F\\u901A\\u8FC7\\u7ED9 DOM \\u8282\\u70B9\\u5728\\u5408\\u9002\\u65F6\\u673A\\u6DFB\\u52A0\\u79FB\\u9664 CSS \\u7C7B\\u540D\\u5B9E\\u73B0\\u7684\\uFF0C\\u5BF9\\u4E8E\\u4E0D\\u540C\\u5E73\\u53F0\\u6709\\u4E0D\\u540C\\u7684\\u5B9E\\u73B0\\u65B9\\u6CD5\\uFF0CTransiton \\u662F\\u9488\\u5BF9\\u6D4F\\u89C8\\u5668\\u5E73\\u53F0\\u5BF9 BaseTransition \\u7684\\u5C01\\u88C5\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-ts\"\n  }), \"// DOM Transition is a higher-order-component based on the platform-agnostic\\n// base Transition component, with DOM-specific logic.\\nexport const Transition: FunctionalComponent<TransitionProps> = (\\n  props,\\n  { slots }\\n) => h(BaseTransition, resolveTransitionProps(props), slots)\\n\\nexport function resolveTransitionProps(\\n  rawProps: TransitionProps\\n): BaseTransitionProps<Element> {\\n  // \\u62FF\\u5230\\u5BF9\\u5E94\\u7684 CSS \\u7C7B\\u540D\\n  let {\\n    name = 'v',\\n    type,\\n    css = true,\\n    duration,\\n    enterFromClass = `${name}-enter-from`,\\n    enterActiveClass = `${name}-enter-active`,\\n    enterToClass = `${name}-enter-to`,\\n    appearFromClass = enterFromClass,\\n    appearActiveClass = enterActiveClass,\\n    appearToClass = enterToClass,\\n    leaveFromClass = `${name}-leave-from`,\\n    leaveActiveClass = `${name}-leave-active`,\\n    leaveToClass = `${name}-leave-to`\\n  } = rawProps\\n  // ...\\n  // \\u91CD\\u5199 hooks \\u56DE\\u8C03\\u51FD\\u6570\\uFF0C\\u6839\\u636E\\u5BF9\\u5E94\\u7684\\u6DFB\\u52A0\\u6216\\u79FB\\u9664 CSS \\u7C7B\\u540D\\n  return extend(baseProps, {\\n    onBeforeEnter(el) {\\n      onBeforeEnter && onBeforeEnter(el)\\n      addTransitionClass(el, enterActiveClass)\\n      addTransitionClass(el, enterFromClass)\\n    },\\n    onBeforeAppear(el) {\\n      onBeforeAppear && onBeforeAppear(el)\\n      addTransitionClass(el, appearActiveClass)\\n      addTransitionClass(el, appearFromClass)\\n    },\\n    // ...\\n  } as BaseTransitionProps<Element>)\\n}\\n\")), mdx(\"p\", null, \"BaseTransition \\u505A\\u7684\\u5C31\\u662F\\u4ECE props \\u4F20\\u5165\\u7684 hooks \\u901A\\u8FC7 resolveTransitionHooks \\u8FDB\\u4E00\\u6B65\\u8FDB\\u884C\\u5C01\\u88C5\\uFF0C\\u5C01\\u88C5\\u6210\\u9488\\u5BF9 diff \\u9636\\u6BB5\\u5404\\u4E2A\\u65F6\\u673A\\u8FDB\\u884C\\u8C03\\u7528\\u7684 hooks\\uFF08beforeEnter\\u3001enter\\u3001leave\\u3001afterLeave\\u3001delayLeave\\u3001clone\\uFF09\\uFF0CsetTransitionHooks \\u5C31\\u662F\\u628A\\u8FD9\\u4E9B hooks \\u653E\\u5230 vnode \\u4E0A\\uFF0C\\u4EE5\\u4FBF\\u5728 diff \\u8FC7\\u7A0B\\u4E2D\\u8FDB\\u884C\\u8C03\\u7528\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-ts\",\n    \"metastring\": \"{29-35,45-52}\",\n    \"{29-35,45-52}\": true\n  }), \"const BaseTransitionImpl = {\\n  name: `BaseTransition`,\\n\\n  props: {\\n    // ...\\n  },\\n\\n  setup(props: BaseTransitionProps, { slots }: SetupContext) {\\n    const instance = getCurrentInstance()!\\n    const state = useTransitionState()\\n    // ...\\n\\n    return () => {\\n      const children =\\n        slots.default && getTransitionRawChildren(slots.default(), true)\\n      // ...\\n\\n      // at this point children has a guaranteed length of 1.\\n      const child = children[0]\\n      // ...\\n\\n      // in the case of <transition><keep-alive/></transition>, we need to\\n      // compare the type of the kept-alive children.\\n      const innerChild = getKeepAliveChild(child)\\n      if (!innerChild) {\\n        return emptyPlaceholder(child)\\n      }\\n\\n      const enterHooks = resolveTransitionHooks(\\n        innerChild,\\n        rawProps,\\n        state,\\n        instance\\n      )\\n      setTransitionHooks(innerChild, enterHooks)\\n\\n      const oldChild = instance.subTree\\n      const oldInnerChild = oldChild && getKeepAliveChild(oldChild)\\n      // ...\\n      if (\\n        oldInnerChild &&\\n        oldInnerChild.type !== Comment &&\\n        (!isSameVNodeType(innerChild, oldInnerChild) || transitionKeyChanged)\\n      ) {\\n        const leavingHooks = resolveTransitionHooks(\\n          oldInnerChild,\\n          rawProps,\\n          state,\\n          instance\\n        )\\n        // update old tree's hooks in case of dynamic transition\\n        setTransitionHooks(oldInnerChild, leavingHooks)\\n        // ...\\n      }\\n\\n      return child\\n    }\\n  }\\n}\\n\")), mdx(\"p\", null, \"\\u8C03\\u7528\\u7684\\u65F6\\u673A\\u5C31\\u662F\\u6709\\u5173 vnode \\u8282\\u70B9\\u4F4D\\u7F6E\\u6539\\u53D8\\u7684\\u65F6\\u5019\\uFF0C\\u5206\\u522B\\u662F mount\\u3001move \\u548C unmount\\u3002mount \\u65F6\\u5C31\\u8C03\\u7528 BeforeEnter\\uFF0C\\u5E76\\u6CE8\\u518C enter \\u5230 post \\u4EFB\\u52A1\\u961F\\u5217\\u4E2D\\uFF1Bunmount \\u65F6\\u5C31\\u8C03\\u7528 leave \\u548C afterLeave\\uFF0C\\u5E76\\u6CE8\\u518C delayLeave \\u5230 post \\u4EFB\\u52A1\\u961F\\u5217\\u4E2D\\uFF1Bmove \\u6839\\u636E moveType \\u7684\\u4E0D\\u540C\\u8C03\\u7528\\u7684\\u4E5F\\u4E0D\\u540C\\uFF0C\\u6BD4\\u5982 Suspense \\u4E2D resolve \\u65F6\\u662F\\u628A children \\u4ECE hiddContainer \\u79FB\\u5230 container \\u4E2D\\uFF0C\\u76F8\\u5F53\\u4E8E mount\\uFF0CKeepAlive \\u7684 activate \\u76F8\\u5F53\\u4E8E mount\\uFF0Cdeactivate \\u76F8\\u5F53\\u4E8E unmount\"), mdx(\"h2\", {\n    \"id\": \"ref\"\n  }, \"Ref\"), mdx(\"p\", null, \"ref\\uFF08\\u6307 runtime \\u7684 ref\\uFF09\\u662F\\u7528\\u6765\\u62FF\\u5230\\u5BBF\\u4E3B\\u73AF\\u5883\\u7684\\u8282\\u70B9\\u5B9E\\u4F8B\\u6216\\u8005\\u7EC4\\u4EF6\\u5B9E\\u4F8B\\u7684\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-js:title=runtime-core/renderer.js\",\n    \"metastring\": \"{7,19,20}\",\n    \"{7,19,20}\": true\n  }), \"const setRef = (ref, oldRef, vnode) => {\\n  // unset old ref\\n  if (oldRef != null && oldRef !== ref) {\\n    if (isRef(oldRef)) oldRef.value = null\\n  }\\n  // set new ref\\n  const value = getRefValue(vnode)\\n  if (isRef(ref)) {\\n    ref.value = value\\n  } else if (isFunction(ref)) {\\n    callWithErrorHandling(ref, getParentInstance(vnode), [value])\\n  } else {\\n    console.warn('Invalid ref type:', value, `(${typeof value})`)\\n  }\\n}\\n\\nconst getRefValue = (vnode) => {\\n  const { type } = vnode\\n  if (isSetupComponent(type)) return vnode.instance\\n  if (isString(type) || isTextType(type)) return vnode.node\\n  return type.getRefValue(internals, { vnode })\\n}\\n\")), mdx(\"p\", null, \"ref \\u7684\\u66F4\\u65B0\\u7531\\u4E8E\\u4F20\\u5165\\u7684 ref\\uFF08\\u6307\\u54CD\\u5E94\\u5F0F ref \\u7528\\u6765\\u63A5\\u6536\\u5B9E\\u4F8B\\uFF09\\u53EF\\u80FD\\u4E0D\\u540C\\uFF08\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"<img ref={num % 2 ? imgRef1 : imgRef2} />\"), \"\\uFF09\\uFF0C\\u6240\\u4EE5\\u8981\\u5148\\u6E05\\u7A7A oldRef\\uFF0C\\u518D\\u8D4B\\u503C newRef\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-js:title=runtime-core/renderer.js\"\n  }), \"const patch = (n1, n2, container, isSVG, anchor = null) => {\\n  // ...\\n  if (n2.ref != null) {\\n    setRef(n2.ref, n1?.ref ?? null, n2)\\n  }\\n}\\n\\nconst unmount = (vnode, doRemove = true) => {\\n  const { type, ref } = vnode\\n  if (ref != null) {\\n    setRef(ref, null, vnode)\\n  }\\n  // ...\\n}\\n\")), mdx(\"p\", null, \"ref \\u7684\\u66F4\\u65B0\\u4E3B\\u8981\\u5728\\u4E24\\u4E2A\\u5730\\u65B9\\uFF0C\\u4E00\\u4E2A\\u662F\\u5728 patch \\u4E4B\\u540E\\uFF0C\\u4E5F\\u5C31\\u662F\\u66F4\\u65B0 DOM \\u8282\\u70B9\\u6216\\u7EC4\\u4EF6\\u5B9E\\u4F8B\\u4E4B\\u540E\\uFF0C\\u4FDD\\u8BC1\\u62FF\\u5230\\u6700\\u65B0\\u7684\\u503C\\uFF0C\\u53E6\\u4E00\\u4E2A\\u662F\\u5728 unmount \\u79FB\\u9664\\u8282\\u70B9\\u4E4B\\u524D\"), mdx(\"h2\", {\n    \"id\": \"complier-优化\"\n  }, \"Complier \\u4F18\\u5316\"), mdx(\"p\", null, \"\\u6CA1\\u6709\\u6BD4 \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://zhuanlan.zhihu.com/p/150732926\"\n  }), \"Vue3 Compiler \\u4F18\\u5316\\u7EC6\\u8282\\uFF0C\\u5982\\u4F55\\u624B\\u5199\\u9AD8\\u6027\\u80FD\\u6E32\\u67D3\\u51FD\\u6570\"), \"\\u8FD9\\u7BC7\\u5199\\u7684\\u66F4\\u597D\\u7684\\u4E86\"), mdx(\"p\", null, \"\\u8FD9\\u91CC\\u7B80\\u5355\\u8BF4\\u4E00\\u4E0B\\u539F\\u7406\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Block Tree \\u548C PatchFlags\")), mdx(\"p\", {\n    parentName: \"li\"\n  }, \"\\u7F16\\u8BD1\\u65F6\\u751F\\u6210\\u7684\\u4EE3\\u7801\\u4F1A\\u6253\\u4E0A patchFlags\\uFF0C\\u7528\\u6765\\u6807\\u8BB0\\u52A8\\u6001\\u90E8\\u5206\\u7684\\u4FE1\\u606F\"), mdx(\"pre\", {\n    parentName: \"li\"\n  }, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-ts\"\n  }), \"export const enum PatchFlags {\\n  // Indicates an element with dynamic textContent (children fast path)\\n  TEXT = 1,\\n\\n  // Indicates an element with dynamic class binding.\\n  CLASS = 1 << 1,\\n\\n  // Indicates an element with dynamic style\\n  STYLE = 1 << 2,\\n\\n  // Indicates an element that has non-class/style dynamic props.\\n  // Can also be on a component that has any dynamic props (includes\\n  // class/style). when this flag is present, the vnode also has a dynamicProps\\n  // array that contains the keys of the props that may change so the runtime\\n  // can diff them faster (without having to worry about removed props)\\n  PROPS = 1 << 3,\\n\\n  // Indicates an element with props with dynamic keys. When keys change, a full\\n  // diff is always needed to remove the old key. This flag is mutually\\n  // exclusive with CLASS, STYLE and PROPS.\\n  FULL_PROPS = 1 << 4,\\n\\n  // Indicates an element with event listeners (which need to be attached during hydration)\\n  HYDRATE_EVENTS = 1 << 5,\\n\\n  // Indicates a fragment whose children order doesn't change.\\n  STABLE_FRAGMENT = 1 << 6,\\n\\n  // Indicates a fragment with keyed or partially keyed children\\n  KEYED_FRAGMENT = 1 << 7,\\n\\n  // Indicates a fragment with unkeyed children.\\n  UNKEYED_FRAGMENT = 1 << 8,\\n\\n  // ...\\n}\\n\")), mdx(\"p\", {\n    parentName: \"li\"\n  }, \"\\u521B\\u5EFA\\u7684 Block \\u4E5F\\u4F1A\\u6709 dynamicProps\\u3001dynamicChildren \\u8868\\u793A\\u52A8\\u6001\\u7684\\u90E8\\u5206\\uFF0CBlock \\u4E5F\\u662F\\u4E00\\u4E2A VNode\\uFF0C\\u53EA\\u4E0D\\u8FC7\\u5B83\\u6709\\u8FD9\\u4E9B\\u52A8\\u6001\\u90E8\\u5206\\u7684\\u4FE1\\u606F\"), mdx(\"p\", {\n    parentName: \"li\"\n  }, \"dynamicChildren \\u4E2D\\u5373\\u5305\\u542B children \\u4E2D\\u52A8\\u6001\\u7684\\u90E8\\u5206\\uFF0C\\u4E5F\\u5305\\u542B children \\u4E2D\\u7684 Block\\uFF0C\\u8FD9\\u6837 Block \\u5C42\\u5C42\\u8FDE\\u63A5\\u5F62\\u6210 Block Tree\\uFF0C\\u5728\\u66F4\\u65B0\\u7684\\u65F6\\u5019\\u53EA\\u66F4\\u65B0\\u52A8\\u6001\\u7684\\u90A3\\u4E00\\u90E8\\u5206\"), mdx(\"pre\", {\n    parentName: \"li\"\n  }, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-ts\",\n    \"metastring\": \"{29-33,37-39,47-58,63-67,74}\",\n    \"{29-33,37-39,47-58,63-67,74}\": true\n  }), \"const patchElement = (\\n  n1: VNode,\\n  n2: VNode,\\n  parentComponent: ComponentInternalInstance | null,\\n  parentSuspense: SuspenseBoundary | null,\\n  isSVG: boolean,\\n  optimized: boolean\\n) => {\\n  const el = (n2.el = n1.el!)\\n  let { patchFlag, dynamicChildren, dirs } = n2\\n  // #1426 take the old vnode's patch flag into account since user may clone a\\n  // compiler-generated vnode, which de-opts to FULL_PROPS\\n  patchFlag |= n1.patchFlag & PatchFlags.FULL_PROPS\\n  const oldProps = n1.props || EMPTY_OBJ\\n  const newProps = n2.props || EMPTY_OBJ\\n  // ...\\n\\n  if (patchFlag > 0) {\\n    // the presence of a patchFlag means this element's render code was\\n    // generated by the compiler and can take the fast path.\\n    // in this path old node and new node are guaranteed to have the same shape\\n    // (i.e. at the exact same position in the source template)\\n    if (patchFlag & PatchFlags.FULL_PROPS) {\\n      // element props contain dynamic keys, full diff needed\\n      patchProps(el, n2, oldProps, newProps, parentComponent, parentSuspense, isSVG)\\n    } else {\\n      // class\\n      // this flag is matched when the element has dynamic class bindings.\\n      if (patchFlag & PatchFlags.CLASS) {\\n        if (oldProps.class !== newProps.class) {\\n          hostPatchProp(el, 'class', null, newProps.class, isSVG)\\n        }\\n      }\\n\\n      // style\\n      // this flag is matched when the element has dynamic style bindings\\n      if (patchFlag & PatchFlags.STYLE) {\\n        hostPatchProp(el, 'style', oldProps.style, newProps.style, isSVG)\\n      }\\n\\n      // props\\n      // This flag is matched when the element has dynamic prop/attr bindings\\n      // other than class and style. The keys of dynamic prop/attrs are saved for\\n      // faster iteration.\\n      // Note dynamic keys like :[foo]=\\\"bar\\\" will cause this optimization to\\n      // bail out and go through a full diff because we need to unset the old key\\n      if (patchFlag & PatchFlags.PROPS) {\\n        // if the flag is present then dynamicProps must be non-null\\n        const propsToUpdate = n2.dynamicProps!\\n        for (let i = 0; i < propsToUpdate.length; i++) {\\n          const key = propsToUpdate[i]\\n          const prev = oldProps[key]\\n          const next = newProps[key]\\n          if (next !== prev || (hostForcePatchProp && hostForcePatchProp(el, key))) {\\n            hostPatchProp(el, key, prev, next, isSVG, n1.children as VNode[], parentComponent, parentSuspense, unmountChildren)\\n          }\\n        }\\n      }\\n    }\\n\\n    // text\\n    // This flag is matched when the element has only dynamic text children.\\n    if (patchFlag & PatchFlags.TEXT) {\\n      if (n1.children !== n2.children) {\\n        hostSetElementText(el, n2.children as string)\\n      }\\n    }\\n  } else if (!optimized && dynamicChildren == null) {\\n    // unoptimized, full diff\\n    patchProps(el, n2, oldProps, newProps, parentComponent, parentSuspense, isSVG)\\n  }\\n\\n  if (dynamicChildren) {\\n    patchBlockChildren(n1.dynamicChildren!, dynamicChildren, el, parentComponent, parentSuspense)\\n  } else if (!optimized) {\\n    // full diff\\n    patchChildren(n1, n2, el, null, parentComponent, parentSuspense)\\n  }\\n\\n  // ...\\n}\\n\"))), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"\\u9759\\u6001\\u63D0\\u5347\")), mdx(\"p\", {\n    parentName: \"li\"\n  }, \"\\u4EE5\\u4E0B\\u662F \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://vue-next-template-explorer.netlify.app/\"\n  }), \"Vue 3 Template Explorer\"), \" \\u9009\\u4E0A hoistStatic \\u8FD9\\u4E2A\\u9009\\u9879\\u540E\\u7F16\\u8BD1\\u51FA\\u7684\\u4EE3\\u7801\"), mdx(\"pre\", {\n    parentName: \"li\"\n  }, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-html\"\n  }), \"<div>\\n  <p>text</p>\\n</div>\\n\")), mdx(\"pre\", {\n    parentName: \"li\"\n  }, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-js\"\n  }), \"import { createVNode as _createVNode, openBlock as _openBlock, createBlock as _createBlock } from \\\"vue\\\"\\n\\nconst _hoisted_1 = /*#__PURE__*/_createVNode(\\\"p\\\", null, \\\"text\\\", -1 /* HOISTED */)\\n\\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\\n  return (_openBlock(), _createBlock(\\\"div\\\", null, [\\n    _hoisted_1\\n  ]))\\n}\\n\")), mdx(\"p\", {\n    parentName: \"li\"\n  }, \"\\u53EF\\u4EE5\\u770B\\u5230 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"<p>text</p>\"), \" \\u751F\\u6210\\u7684\\u662F _hoisted_1 \\u53D8\\u91CF\\uFF0C\\u5728 render \\u4F5C\\u7528\\u57DF\\u5916\\u9762\\uFF0C\\u8FD9\\u6837\\u6BCF\\u6B21 render \\u51FD\\u6570\\u8C03\\u7528\\u662F\\u5C31\\u53EF\\u4EE5\\u670D\\u7528 _hoisted_1\\uFF0C\\u51CF\\u5C11 VNode \\u521B\\u5EFA\\u7684\\u6027\\u80FD\\u6D88\\u8017\")), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"\\u9884\\u5B57\\u7B26\\u4E32\\u5316\"), mdx(\"pre\", {\n    parentName: \"li\"\n  }, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-html\"\n  }), \"<div>\\n  <p>text</p>\\n  <p>text</p>\\n  <p>text</p>\\n  <p>text</p>\\n  <p>text</p>\\n  <p>text</p>\\n  <p>text</p>\\n  <p>text</p>\\n  <p>text</p>\\n  <p>text</p>\\n</div>\\n\")), mdx(\"pre\", {\n    parentName: \"li\"\n  }, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-js\"\n  }), \"import { createVNode as _createVNode, createStaticVNode as _createStaticVNode, openBlock as _openBlock, createBlock as _createBlock } from \\\"vue\\\"\\n\\nconst _hoisted_1 = /*#__PURE__*/_createStaticVNode(\\\"<p>text</p><p>text</p><p>text</p><p>text</p><p>text</p><p>text</p><p>text</p><p>text</p><p>text</p><p>text</p>\\\", 10)\\n\\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\\n  return (_openBlock(), _createBlock(\\\"div\\\", null, [\\n    _hoisted_1\\n  ]))\\n}\\n\")), mdx(\"p\", {\n    parentName: \"li\"\n  }, \"\\u5F53\\u6709\\u5927\\u91CF\\u8FDE\\u7EED\\u7684\\u9759\\u6001\\u7684\\u8282\\u70B9\\u65F6\\uFF0C\\u76F8\\u6BD4\\u9759\\u6001\\u63D0\\u5347\\uFF0C\\u9884\\u5B57\\u7B26\\u4E32\\u5316\\u4F1A\\u8FDB\\u4E00\\u6B65\\u8FDB\\u884C\\u4F18\\u5316\\uFF0C\\u901A\\u8FC7\\u5B57\\u7B26\\u4E32\\u521B\\u5EFA Static VNode\"), mdx(\"pre\", {\n    parentName: \"li\"\n  }, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-ts\",\n    \"metastring\": \"{16-20,30}\",\n    \"{16-20,30}\": true\n  }), \"const patch: PatchFn = (\\n  n1,\\n  n2,\\n  container,\\n  anchor = null,\\n  parentComponent = null,\\n  parentSuspense = null,\\n  isSVG = false,\\n  optimized = false\\n) => {\\n  // ...\\n  const { type, ref, shapeFlag } = n2\\n  switch (type) {\\n    // ...\\n    case Static:\\n      if (n1 == null) {\\n        mountStaticNode(n2, container, anchor, isSVG)\\n      } else if (__DEV__) {\\n        patchStaticNode(n1, n2, container, isSVG)\\n      }\\n      break\\n    // ...\\n  }\\n  // ...\\n}\\n\\nconst mountStaticNode = (n2: VNode, container: RendererElement, anchor: RendererNode | null, isSVG: boolean) => {\\n  // static nodes are only present when used with compiler-dom/runtime-dom\\n  // which guarantees presence of hostInsertStaticContent.\\n  ;[n2.el, n2.anchor] = hostInsertStaticContent!(n2.children as string, container, anchor, isSVG)\\n}\\n\")), mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Static VNode \\u4F1A\\u5728 patch \\u662F\\u76F4\\u63A5\\u63D2\\u5165\\u5230 container \\u4E2D\\uFF0C\\u751F\\u4EA7\\u73AF\\u8282\\u4E0B\\u4E0D\\u8FDB\\u884C\\u66F4\\u65B0\"), mdx(\"p\", {\n    parentName: \"li\"\n  }, \"\\u9884\\u5B57\\u7B26\\u4E32\\u5316\\u7684\\u597D\\u5904\\u6709\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"\\u751F\\u6210\\u4EE3\\u7801\\u7684\\u4F53\\u79EF\\u51CF\\u5C11\\u3001\\u51CF\\u5C11\\u521B\\u5EFA VNode \\u7684\\u5F00\\u9500\\u3001\\u51CF\\u5C11\\u5185\\u5B58\\u5360\\u7528\")))), mdx(\"h2\", {\n    \"id\": \"-ramble\"\n  }, \"\\uD83D\\uDE03 ramble\"), mdx(\"p\", null, \"Vue3 \\u6E90\\u7801\\u7CFB\\u5217\\u7ED3\\u675F\\uFF01\"), mdx(\"p\", null, \"Vue3 \\u76EE\\u524D\\u5199\\u7684\\u53EA\\u662F\\u5B83\\u7684\\u54CD\\u5E94\\u5F0F\\u7CFB\\u7EDF\\u548C\\u8FD0\\u884C\\u65F6\\uFF0C\\u8FD8\\u6709\\u5F88\\u5927\\u7684\\u4E00\\u4E2A\\u90E8\\u5206 complier\\uFF0C\\u8FD9\\u4E00\\u90E8\\u5206\\u7531\\u4E8E\\u6211\\u5BF9\\u7F16\\u8BD1\\u76EE\\u524D\\u8FD8\\u6CA1\\u6709\\u592A\\u591A\\u7684\\u4E86\\u89E3\\uFF0C\\u800C\\u4E14\\u5BF9\\u4E8E\\u7406\\u89E3 Vue3 \\u6838\\u5FC3\\u539F\\u7406\\u5F71\\u54CD\\u5E76\\u4E0D\\u5927\\uFF0C\\u6240\\u4EE5\\u5C31\\u6CA1\\u6709\\u5199\\uFF0C\\u4EE5\\u540E\\u53EF\\u80FD\\u4F1A\\u5199\\u4E00\\u5199\\u5427\"), mdx(\"p\", null, \"\\u4E4B\\u540E\\u5C31\\u662F React \\u7684\\u6E90\\u7801\\u4E86\\uFF0C\\u81F3\\u4E8E\\u6211\\u4E3A\\u4EC0\\u4E48\\u70ED\\u8877\\u4E8E\\u770B\\u6E90\\u7801\\uFF0C\\u4E0D\\u4EC5\\u662F\\u56E0\\u4E3A\\u81EA\\u5DF1\\u7684\\u5B66\\u4E60\\u4E60\\u60EF\\uFF0C\\u4E5F\\u662F\\u56E0\\u4E3A\\u8FD9\\u4E9B\\u6846\\u67B6\\u7684\\u6E90\\u7801\\u76F8\\u5F53\\u4E8E\\u524D\\u7AEF\\u7684\\u201C\\u8FB9\\u754C\\u201D\\uFF0C\\u4E0D\\u4EC5\\u4EE3\\u8868\\u7740\\u6311\\u6218\\u4E5F\\u4EE3\\u8868\\u7740\\u6211\\u8FD9\\u4E00\\u6280\\u672F\\u65B9\\u5411\\u7684\\u6DF1\\u5EA6\"), mdx(\"blockquote\", null, mdx(\"p\", {\n    parentName: \"blockquote\"\n  }, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/ahabhgk/simple-vue3\"\n  }), \"simple-vue \\u5B9E\\u73B0\\u5B8C\\u6574\\u4EE3\\u7801\"))));\n}\n;\nMDXContent.isMDXComponent = true;","excerpt":"Table of Contents 序 Vue3 中内置组件和一些其他新特性的实现原理，作为上一篇的补充 Fragment 这五个方法会在哪里调用可以看上一篇，有具体的讲解和代码，Fragment 就是直接将子节点进行渲染，本身可以用两个 placeholder…","timeToRead":3,"banner":null}},"pageContext":{"slug":"/blog/vue3-compat","formatString":"DD.MM.YYYY"}},"staticQueryHashes":["318001574","3787687951","3787687951"]}