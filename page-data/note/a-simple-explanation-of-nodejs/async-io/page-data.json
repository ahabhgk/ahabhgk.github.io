{"componentChunkName":"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-page-query-tsx","path":"/note/a-simple-explanation-of-nodejs/async-io","result":{"data":{"page":{"__typename":"MdxPage","title":"异步 I/O","slug":"/note/a-simple-explanation-of-nodejs/async-io","excerpt":"为什么要异步 I/O？ 用户体验 资源分配 单线程串行：阻塞，CPU 利用效率低 多线程并行：创建线程和执行期线程上下文切换开销较大；锁、状态同步等问题 异步 I/O…","body":"function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"异步 I/O\",\n  \"slug\": \"/note/a-simple-explanation-of-nodejs/async-io\",\n  \"date\": \"2020-10-24T00:00:00.000Z\",\n  \"description\": \"《深入浅出 NodeJS》读书笔记\",\n  \"tags\": [\"Note\", \"A Simple Explanation of NodeJS\"]\n};\n\nvar makeShortcode = function makeShortcode(name) {\n  return function MDXDefaultShortcode(props) {\n    console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n    return mdx(\"div\", props);\n  };\n};\n\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"\\u4E3A\\u4EC0\\u4E48\\u8981\\u5F02\\u6B65 I/O\\uFF1F\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"\\u7528\\u6237\\u4F53\\u9A8C\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"\\u8D44\\u6E90\\u5206\\u914D\", mdx(\"ul\", {\n    parentName: \"li\"\n  }, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"\\u5355\\u7EBF\\u7A0B\\u4E32\\u884C\\uFF1A\\u963B\\u585E\\uFF0CCPU \\u5229\\u7528\\u6548\\u7387\\u4F4E\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"\\u591A\\u7EBF\\u7A0B\\u5E76\\u884C\\uFF1A\\u521B\\u5EFA\\u7EBF\\u7A0B\\u548C\\u6267\\u884C\\u671F\\u7EBF\\u7A0B\\u4E0A\\u4E0B\\u6587\\u5207\\u6362\\u5F00\\u9500\\u8F83\\u5927\\uFF1B\\u9501\\u3001\\u72B6\\u6001\\u540C\\u6B65\\u7B49\\u95EE\\u9898\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"\\u5F02\\u6B65 I/O\\uFF1A\\u5229\\u7528\\u5355\\u7EBF\\u7A0B\\u8FDC\\u79BB\\u9501\\u3001\\u72B6\\u6001\\u540C\\u6B65\\u7B49\\u95EE\\u9898\\uFF1B\\u540C\\u65F6\\u8BA9\\u5355\\u7EBF\\u7A0B\\u8FDC\\u79BB\\u963B\\u585E\")))), mdx(\"p\", null, \"\\u963B\\u585E/\\u975E\\u963B\\u585E\\u4E0E\\u540C\\u6B65/\\u5F02\\u6B65\\uFF08\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://www.zhihu.com/question/19732473/answer/20851256\"\n  }), \"\\u600E\\u6837\\u7406\\u89E3\\u963B\\u585E\\u975E\\u963B\\u585E\\u4E0E\\u540C\\u6B65\\u5F02\\u6B65\\u7684\\u533A\\u522B\\uFF1F- \\u77E5\\u4E4E\"), \"\\uFF09\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"\\u64CD\\u4F5C\\u7CFB\\u7EDF\\u5BF9\\u4E8E I/O \\u53EA\\u6709\\u4E24\\u79CD\\u65B9\\u5F0F\\uFF1A\\u963B\\u585E\\u548C\\u975E\\u963B\\u585E\"), mdx(\"ul\", {\n    parentName: \"li\"\n  }, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"\\u963B\\u585E I/O \\u8C03\\u7528\\u4E4B\\u540E\\u8981\\u7B49\\u7CFB\\u7EDF\\u5185\\u6838\\u5B8C\\u6210\\u6240\\u6709\\u64CD\\u4F5C\\u540E\\uFF0C\\u8C03\\u7528\\u624D\\u7ED3\\u675F\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"\\u975E\\u963B\\u585E I/O \\u8C03\\u7528\\u4E4B\\u540E\\u4F1A\\u7ACB\\u5373\\u8FD4\\u56DE\", mdx(\"ul\", {\n    parentName: \"li\"\n  }, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"OS \\u5C06\\u8BA1\\u7B97\\u673A\\u6240\\u6709\\u8F93\\u5165\\u8F93\\u51FA\\u8BBE\\u5907\\u62BD\\u8C61\\u4E3A\\u6587\\u4EF6\\uFF0C\\u5185\\u6838\\u5728 I/O \\u64CD\\u4F5C\\u65F6\\u901A\\u8FC7\\u6587\\u4EF6\\u63CF\\u8FF0\\u7B26\\u8FDB\\u884C\\u7BA1\\u7406\\uFF0C\\u6587\\u4EF6\\u63CF\\u8FF0\\u7B26\\u7C7B\\u4F3C\\u4E8E\\u5E94\\u7528\\u7A0B\\u5E8F\\u4E0E\\u7CFB\\u7EDF\\u5185\\u6838\\u4E4B\\u95F4\\u7684\\u51ED\\u8BC1\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"\\u975E\\u963B\\u585E I/O \\u8FD4\\u56DE\\u4E4B\\u540E\\uFF0CCPU \\u53EF\\u4EE5\\u7528\\u6765\\u5904\\u7406\\u5176\\u4ED6\\u4E8B\\u52A1\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"\\u5B8C\\u6574 I/O \\u6CA1\\u6709\\u5B8C\\u6210\\uFF0C\\u4E1A\\u52A1\\u5C42\\u4E3A\\u4E86\\u5F97\\u5230\\u5B8C\\u6574\\u7684\\u6570\\u636E\\uFF0C\\u9700\\u8981\\u8FDB\\u884C\\u8F6E\\u8BE2\\uFF08poll\\u3001epoll\\uFF09\"))))), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"\\u7406\\u60F3\\u7684\\u975E\\u963B\\u585E\\u5F02\\u6B65 I/O\\uFF1A\\u5728 I/O \\u5B8C\\u6210\\u540E\\u901A\\u8FC7\\u4FE1\\u53F7\\u6216\\u56DE\\u8C03\\u5C06\\u6570\\u636E\\u4F20\\u9012\\u7ED9\\u5E94\\u7528\\u7A0B\\u5E8F\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"\\u73B0\\u5B9E\\u7684\\u5F02\\u6B65 I/O\\uFF1A\\u8BA9\\u90E8\\u5206\\u7EBF\\u7A0B\\u8FDB\\u884C\\u963B\\u585E I/O \\u6216\\u975E\\u963B\\u585E I/O + \\u8F6E\\u8BE2\\u6765\\u5B8C\\u6210\\u6570\\u636E\\u83B7\\u53D6\\uFF0C\\u8BA9\\u4E3B\\u7EBF\\u7A0B\\u8FDB\\u884C\\u6570\\u636E\\u5904\\u7406\\uFF0C\\u901A\\u8FC7\\u7EBF\\u7A0B\\u4E4B\\u95F4\\u7684\\u901A\\u4FE1\\u4F20\\u9012 I/O \\u5F97\\u5230\\u7684\\u6570\\u636E\\uFF0C\\u6A21\\u62DF\\u5F02\\u6B65 I/O\"), mdx(\"p\", {\n    parentName: \"li\"\n  }, \"  \", mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"942px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"62.083333333333336%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABYlAAAWJQFJUiTwAAABP0lEQVQoz22T2a6DMAxE+f+fgzeekFhEWctWugAFX51IRgm3lqwQezwZx8H7fr/S973c73cJgkCSJJHH4yHv91u2bTO5oijE932J41imaTI+juMZT9NUhmEweG/fd1P8er2krmtDtiyLED+Ow3yTb5pG5nmWz+djYqzsqWEFQ40nlkGq5OqAUYM6VFwNEts8VGC0TiuQAGKvjhquoixLg6UGB7euqxM7CUnSrgKuKm63mzyfTydOLR1xqO4dwrZtT5XqFBDLsswcqHG+8SiKJM9zUR6HkInSnu51MKimXcg1RxxsVVVmYD8VogRSFEAQhqFZKWQgdmsYByj+HyFgpnlVqGbfrU3Ydd2p3CHEkM4D16fDHTFdngyFxBgMrnnunQf9U6H+IZokZg/Hfh7qNpkzFFbu8AqwW77GdGD2QX8tsac4U1VBPgAAAABJRU5ErkJggg==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"img\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"现实中的异步 I/O\",\n    \"title\": \"现实中的异步 I/O\",\n    \"src\": \"/static/547871be83f158945f5936740dd1589d/1995d/async-io.png\",\n    \"srcSet\": [\"/static/547871be83f158945f5936740dd1589d/5243c/async-io.png 240w\", \"/static/547871be83f158945f5936740dd1589d/ab158/async-io.png 480w\", \"/static/547871be83f158945f5936740dd1589d/1995d/async-io.png 942w\"],\n    \"sizes\": \"(max-width: 942px) 100vw, 942px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\"\n  })), \"\\n    \")))), mdx(\"h2\", {\n    \"id\": \"node-的异步-io\"\n  }, \"Node \\u7684\\u5F02\\u6B65 I/O\"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"606px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"68.75%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAABYlAAAWJQFJUiTwAAABd0lEQVQ4y2WU166DQAxE8//flgeeUgglCelAelWKr46luWJhpRGwbuPxLr3f72es+/1uh8PBTqeTHY/H/+f5fLbb7ea4XC6+14T8Xq+X5+kpIZvv99u+3699Ph8Htuv1arPZzBaLhfs07fJ5PB5eOEi43++dxfP5dAfAO455nluSJLbZbAI7gBk+MA0S4ggbtScoUMXadkAc3QUJ2RArQQzQrigKf2/7CEgRJGQgYsSAmijL0tuFSdsuWToaklAit7FcLm04HHpBFmxkk1wdDanOpgTWO6Bl7Dxla/owfZgHCXmio46OdIU1yWCpDrSaMfoOWqYSLAjmqMBAhxkdaZkzOZlMLE1THxQMOXL4dTTUrSB4PB57Ig2CRRAJB4OBQz6SpZMQZnEce+XRaGT9ft+iKLL1eu2FJDy3BoYU0y3rTLmua1utVp5sPp9blmU2nU699e1265Pc7XYeTGH8iOG7qqpuQhhIQ7Ug6AfQ/CFouoDu9HP4A3hsNqhR4touAAAAAElFTkSuQmCC')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"img\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"基于 libuv 的架构图\",\n    \"title\": \"基于 libuv 的架构图\",\n    \"src\": \"/static/e0bdf95f2b6f581015d3edaec475cacf/7e623/node-libuv.png\",\n    \"srcSet\": [\"/static/e0bdf95f2b6f581015d3edaec475cacf/5243c/node-libuv.png 240w\", \"/static/e0bdf95f2b6f581015d3edaec475cacf/ab158/node-libuv.png 480w\", \"/static/e0bdf95f2b6f581015d3edaec475cacf/7e623/node-libuv.png 606w\"],\n    \"sizes\": \"(max-width: 606px) 100vw, 606px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\"\n  })), \"\\n    \")), mdx(\"p\", null, \"libuv \\u5728 *uix \\u548C Windows \\u4E0A\\u90FD\\u662F\\u901A\\u8FC7\\u7EBF\\u7A0B\\u6C60\\u5B9E\\u73B0\\u7684\\u5F02\\u6B65 I/O\\uFF0C\\u6240\\u4EE5 Node \\u5E76\\u4E0D\\u662F\\u5355\\u7EBF\\u7A0B\\u67B6\\u6784\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-text\"\n  }), \"lib/fs.js          ( fs.open()    )\\nsrc/node_file.cc   ( Open         )\\ndeps/uv/unix/fs.c  ( uv_fs_open() )\\n\")), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"uv_fs_open \\u8C03\\u7528\\u8FC7\\u7A0B\\u4E2D\\u4F1A\\u521B\\u5EFA\\u4E00\\u4E2A\\u8BF7\\u6C42\\u5BF9\\u8C61\\uFF0C\\u628A\\u4F20\\u5165\\u7684 callback \\u653E\\u5230\\u8FD9\\u4E2A\\u8BF7\\u6C42\\u5BF9\\u8C61\\u4E0A\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"\\u7EC4\\u88C5\\u597D\\u8BF7\\u6C42\\u5BF9\\u8C61\\u540E\\u4F1A\\u653E\\u5165 I/O \\u7EBF\\u7A0B\\u6C60\\u4E2D\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"\\u7EBF\\u7A0B\\u6C60\\u4E2D\\u7684 I/O \\u5B8C\\u6BD5\\u540E\\uFF0C\\u628A\\u7ED3\\u679C\\u653E\\u5230\\u8BF7\\u6C42\\u5BF9\\u8C61\\u4E0A\\uFF0C\\u5E76\\u901A\\u8FC7 I/O \\u89C2\\u5BDF\\u8005\\uFF08\\u6BCF\\u6B21 Tick \\u4F1A\\u68C0\\u67E5\\u7EBF\\u7A0B\\u6C60\\u4E2D\\u662F\\u5426\\u6709\\u6267\\u884C\\u5B8C\\u7684\\u8BF7\\u6C42\\uFF09\\u628A\\u8BF7\\u6C42\\u5BF9\\u8C61\\u653E\\u5230\\u4EFB\\u52A1\\u961F\\u5217\\u4E2D\\uFF0C\\u5C06\\u5176\\u5F53\\u4F5C\\u4E8B\\u4EF6\\u5904\\u7406\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-text\"\n  }), \"   \\u250C\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2510\\n\\u250C\\u2500>\\u2502           timers          \\u2502  (setTimeout, setInterval)\\n\\u2502  \\u2514\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u252C\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2518\\n\\u2502  \\u250C\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2534\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2510\\n\\u2502  \\u2502     pending callbacks     \\u2502  (I/O callbacks deferred to the next loop)\\n\\u2502  \\u2514\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u252C\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2518\\n\\u2502  \\u250C\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2534\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2510\\n\\u2502  \\u2502       idle, prepare       \\u2502  (only use internally, process.nextTick)\\n\\u2502  \\u2514\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u252C\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2518      \\u250C\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2510\\n\\u2502  \\u250C\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2534\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2510      \\u2502   incoming:   \\u2502\\n\\u2502  \\u2502           poll            \\u2502<\\u2500\\u2500\\u2500\\u2500\\u2500\\u2524  connections, \\u2502  (retrieve new I/O events; execute I/O related callbacks (almost all with the exception of close callbacks, the ones scheduled by timers, and setImmediate()); node will **block** here when appropriate)\\n\\u2502  \\u2514\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u252C\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2518      \\u2502   data, etc.  \\u2502\\n\\u2502  \\u250C\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2534\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2510      \\u2514\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2518\\n\\u2502  \\u2502           check           \\u2502  (setImmediate)\\n\\u2502  \\u2514\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u252C\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2518\\n\\u2502  \\u250C\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2534\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2510\\n\\u2514\\u2500\\u2500\\u2524      close callbacks      \\u2502  (some close callbacks)\\n   \\u2514\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2518\\n\")), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"\\u6BCF\\u4E2A\\u9636\\u6BB5\\u90FD\\u6709\\u4E00\\u4E2A FIFO \\u961F\\u5217\"), \"\\u6765\\u6267\\u884C\\u56DE\\u8C03\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-c\"\n  }), \"// [uv_run \\u4E8B\\u4EF6\\u5FAA\\u73AF\\u6E90\\u7801](https://github.com/nodejs/node/blob/master/deps/uv/src/unix/core.c#L365)\\nwhile (r != 0 && loop->stop_flag == 0) {\\n  uv__update_time(loop);\\n  uv__run_timers(loop);\\n  ran_pending = uv__run_pending(loop);\\n  uv__run_idle(loop);\\n  uv__run_prepare(loop);\\n\\n  timeout = 0;\\n  if ((mode == UV_RUN_ONCE && !ran_pending) || mode == UV_RUN_DEFAULT)\\n    timeout = uv_backend_timeout(loop);\\n\\n  uv__io_poll(loop, timeout);\\n  \\n  // ...\\n\\n  uv__run_check(loop);\\n  uv__run_closing_handles(loop);\\n  \\n  // ...\\n}\\n\")), mdx(\"p\", null, \"uv\", \"_\", \"_\", \"io\", \"_\", \"poll \\u4E4B\\u524D\\u4F1A\\u8C03\\u7528 uv\", \"_\", \"backend\", \"_\", \"timeout \\u56DE\\u53BB timeout\\uFF0Cuv\", \"_\", \"backend\", \"_\", \"timeout \\u4E2D\\u68C0\\u6D4B uv\", \"_\", \"_\", \"has\", \"_\", \"active\", \"_\", \"handles\\u3001uv\", \"_\", \"_\", \"has\", \"_\", \"active\", \"_\", \"reqs\\u3001idle\", \"_\", \"handles\\u3001pending\", \"_\", \"queue\\u3001closing\", \"_\", \"handles \\u90FD\\u6CA1\\u6709\\u5C31\\u8FD4\\u56DE 0\\uFF0C\\u5426\\u5219 uv\", \"_\", \"_\", \"next\", \"_\", \"timeout \\u83B7\\u53D6 timeout\"), mdx(\"p\", null, \"uv\", \"_\", \"_\", \"next\", \"_\", \"timeout \\u4E2D\\u83B7\\u53D6\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"\\u8DDD\\u79BB\\u6B64\\u65F6\\u6B64\\u523B\\u6700\\u5148\\u5230\\u671F\\u7684\\u4E00\\u4E2A timer \\u7684\\u65F6\\u95F4\")), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"\\u6CA1\\u6709 timer \\u5C31\\u8FD4\\u56DE -1\\uFF0C\\u8868\\u793A\\u5C06\\u5728 poll \\u9636\\u6BB5\\u65E0\\u9650\\u5236\\u963B\\u585E\\uFF0C\\u4EE5\\u5B9E\\u73B0\\u4E4B\\u540E\\u6709\\u5F02\\u6B65 I/O \\u5B8C\\u6210\\u53EF\\u4EE5\\u7ACB\\u5373\\u54CD\\u5E94\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"\\u6700\\u8FD1\\u8BA1\\u65F6\\u5668\\u65F6\\u95F4\\u8282\\u70B9\\u5C0F\\u4E8E\\u7B49\\u4E8E\\u4E8B\\u4EF6\\u5FAA\\u73AF\\u5F00\\u59CB\\u65F6\\u95F4\\uFF0C\\u8868\\u660E\\u6709\\u8FC7\\u671F\\u7684 timer\\uFF0C\\u5219\\u8FD4\\u56DE 0 \\u4E0D\\u8FDB\\u884C\\u963B\\u585E\\uFF0C\\u4EE5\\u5C3D\\u5FEB\\u8FDB\\u5165\\u4E0B\\u4E00\\u5FAA\\u73AF\\u6267\\u884C\\u8FC7\\u671F\\u7684 timer\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"\\u6700\\u8FD1\\u8BA1\\u65F6\\u5668\\u65F6\\u95F4\\u8282\\u70B9\\u5927\\u4E8E\\u4E8B\\u4EF6\\u5FAA\\u73AF\\u5F00\\u59CB\\u65F6\\u95F4\\uFF0C\\u5219\\u8BA1\\u7B97\\u8FD9\\u4E24\\u4E2A\\u7684\\u5DEE\\u503C\\uFF0C\\u8FDB\\u884C\\u9002\\u5F53\\u65F6\\u95F4\\u7684\\u963B\\u585E\\uFF08\\u5DEE\\u503C\\u6216 INT_MAX\\uFF09\\uFF0C\\u4EE5\\u5B9E\\u73B0\\u5C3D\\u53EF\\u80FD\\u5FEB\\u7684\\u5904\\u7406\\u5F02\\u6B65 I/O \\u4E8B\\u4EF6\")), mdx(\"p\", null, \"\\u63A8\\u8350\\u9605\\u8BFB\\uFF1A\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"https://set.sh/post/200317-how-nodejs-event-loop-works\"\n  }), \"\\u4ECE libuv \\u770B nodejs \\u4E8B\\u4EF6\\u5FAA\\u73AF\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"https://nodejs.org/zh-cn/docs/guides/event-loop-timers-and-nexttick/\"\n  }), \"The Node.js Event Loop, Timers, and process.nextTick()\"))), mdx(\"h2\", {\n    \"id\": \"processnexttick-和-setimmediate-区别\"\n  }, \"process.nextTick \\u548C setImmediate \\u533A\\u522B\"), mdx(\"p\", null, \"nextTick \\u7684\\u56DE\\u8C03\\u51FD\\u6570\\u4FDD\\u5B58\\u5728\\u6570\\u7EC4\\u4E0A\\uFF0CsetImmediate \\u7684\\u56DE\\u8C03\\u51FD\\u6570\\u4FDD\\u5B58\\u5728\\u94FE\\u8868\\u4E0A\\uFF0CnextTick \\u4F1A\\u5728\\u6BCF\\u8F6E\\u5FAA\\u73AF\\u5C06\\u6570\\u7EC4\\u4E2D\\u6240\\u6709\\u7684\\u56DE\\u8C03\\u5168\\u90E8\\u6267\\u884C\\u5B8C\\uFF0CsetImmediate \\u6BCF\\u8F6E\\u5FAA\\u73AF\\u53EA\\u6267\\u884C\\u94FE\\u8868\\u4E2D\\u7684\\u4E00\\u4E2A\\u56DE\\u8C03\\u51FD\\u6570\"), mdx(\"p\", null, \"nextTick \\u5728 idle \\u9636\\u6BB5\\uFF0CsetImmediate \\u5728 check \\u9636\\u6BB5\\uFF0C\\u4F18\\u5148\\u7EA7 idle > poll > check\"), mdx(\"p\", null, \"\\u5B9E\\u9645\\u4E0A\\u8FD9\\u4E24\\u4E2A\\u540D\\u5B57\\u6362\\u4E00\\u4E0B\\u66F4\\u5408\\u9002\\uFF0C\\u4F46\\u8FD9\\u662F\\u8FC7\\u53BB\\u9057\\u7559\\u95EE\\u9898\\u4E0D\\u80FD\\u968F\\u610F\\u6539\\u53D8\"), mdx(\"h2\", {\n    \"id\": \"浏览器上的事件循环\"\n  }, \"\\u6D4F\\u89C8\\u5668\\u4E0A\\u7684\\u4E8B\\u4EF6\\u5FAA\\u73AF\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"https://juejin.im/post/6844904165462769678\"\n  }), \"\\u6DF1\\u5165\\u89E3\\u6790\\u4F60\\u4E0D\\u77E5\\u9053\\u7684 EventLoop \\u548C\\u6D4F\\u89C8\\u5668\\u6E32\\u67D3\\u3001\\u5E27\\u52A8\\u753B\\u3001\\u7A7A\\u95F2\\u56DE\\u8C03\\uFF08\\u52A8\\u56FE\\u6F14\\u793A\\uFF09\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"https://html.spec.whatwg.org/multipage/webappapis.html#event-loops\"\n  }), \"WHATWG spec\"))));\n}\n;\nMDXContent.isMDXComponent = true;"}},"pageContext":{"slug":"/note/a-simple-explanation-of-nodejs/async-io"}},"staticQueryHashes":["318001574","3787687951","3787687951"]}