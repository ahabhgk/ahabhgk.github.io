---
title: è¯»ã€Š7 å‘¨ 7 è¯­è¨€ã€‹- Io
date: 2020-02-27
description: ã€Š7 å‘¨ 7 è¯­è¨€ã€‹è¯»ä¹¦ç¬”è®°
tags:
  - Note
  - ã€Š7 å‘¨ 7 è¯­è¨€ã€‹
---

> Io è¯­æ³•åªä¸è¿‡æŠŠæ¶ˆæ¯å…¨éƒ¨ä¸²è”èµ·æ¥ï¼Œæ¯ä¸ªæ¶ˆæ¯éƒ½è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œæ¯æ¡æ¶ˆæ¯éƒ½ä¹Ÿéƒ½å¸¦æœ‰æ‹¬å·å†…çš„å¯é€‰å‚æ•°
> Io ä¸­ï¼Œä¸€åˆ‡çš†ä¸ºæ¶ˆæ¯ï¼Œä¸”æ¯æ¡æ¶ˆæ¯éƒ½ä¼šè¿”å›å¦ä¸€æ¡æ¥å—æ¶ˆæ¯çš„å¯¹è±¡
> Io æ²¡æœ‰ç±»ï¼Œåªéœ€è¦ä¸å¯¹è±¡æ‰“äº¤é“ï¼Œå¿…è¦æ—¶æŠŠå¯¹è±¡å¤åˆ¶ä¸€ä¸‹å°±è¡Œï¼Œè¿™äº›è¢«å¤åˆ¶çš„å¯¹è±¡å«åŸå‹ï¼ŒåŸå‹è¯­è¨€ä¸­ï¼Œæ¯ä¸ªå¯¹è±¡éƒ½ä¸æ˜¯ç±»çš„å¤åˆ¶å“ï¼Œè€Œæ˜¯ä¸€ä¸ªå®å®åœ¨åœ¨çš„å¯¹è±¡

```shell
brew install io
```

æ‰€æœ‰äº‹ç‰©éƒ½æ˜¯å¯¹è±¡ï¼Œå¯¹ç”±äºå¯¹è±¡äº¤äº’çš„éƒ½æ˜¯æ¶ˆæ¯

æ¶ˆæ¯ï¼šå·¦è¾¹çš„æ˜¯å¯¹è±¡ï¼Œå³è¾¹çš„æ˜¯æ¶ˆæ¯ï¼ŒæŠŠæ¶ˆæ¯å‘ç»™å¯¹è±¡

```io
"Hello, Io" print // "Hello, Io" å¯¹è±¡æ¥æ”¶ print æ¶ˆæ¯
// => "Hello, Io"
Vehicle := Object clone // Object æ˜¯è·Ÿå¯¹è±¡ï¼Œå‘é€ clone æ¶ˆæ¯ï¼Œè¿”å›ä¸€ä¸ªæ–°å¯¹è±¡ï¼Œå¹¶èµ‹å€¼ç»™ Vehicle
Vehicle description := "gogogo" // å¯¹è±¡ä¸Šæœ‰æ§½ï¼Œ:= æ²¡æœ‰åˆ™åˆ›å»ºå¹¶èµ‹å€¼ï¼Œ= åªèµ‹å€¼ï¼Œæ²¡æœ‰åˆ™æŠ¥é”™
Vehicle type // => Vehicleï¼Œæ¯ä¸ªå¯¹è±¡éƒ½æœ‰ type æ§½
Vehicle slotNames // => list(type, description)
```

åŸå‹

```io
Vehicle proto // => Object
Car := Vehicle clone
ferrari := Car clone
ferrari slotNames // => list() type åº”è¯¥æ˜¯å¤§å†™å¼€å¤´
ferrari type // => Car å¾—åˆ°åŸå‹

Car drive := method("Vroom" println)
ferrari drive // => "Vroom"
ferrari proto // => Car

Lobby // ä¸»å‘½åç©ºé—´
```

List

```io
nums := list(1, 2, 3, 4)
nums size // => 4
nums append(5)
nums average // => 3
nums pop
nums prepend
nums isEmpty // => false
```

Map

```io
elvis := Map clone
elvis atPut("home", "Graceland")
elvis at("home") // => "Graceland"
elvis atPut("style", "ror")
elvis asObject // => home = "Graceland" style = "ror"
elvis asList // => list(list("home", "Graceland"), list("style", "ror"))
elvis size // => 2
elvis keys // => list("home", "style")
```

true false nil éƒ½æ˜¯å•ä¾‹

```io
true proto // => Object
true clone // => true

// å®ç°å•ä¾‹
Highlander := Object clone
Highlander clone := Highlander
```

æ¡ä»¶å’Œå¾ªç¯

```io
i := 1
while(i <= 3, i println; i = i + 1); "end" println // ; ä¼šæŠŠä¸¤ä¸ªæ¶ˆæ¯è¿æ¥æ‰§è¡Œ
// 1
// 2
// 3
// end

for(i, 1, 11, 2, i println)
// 1
// 3
// 5
// 7
// 9
// 11
// => 11

loop("dead loop" println) // ...

if(true, "it's true", "it's false") // "it's true"
```

è¿ç®—ç¬¦

```io
OperatorTable
// ==> OperatorTable_0x7facc5448ee0:
// Operators
//   0   ? @ @@
//   1   **
//   2   % * /
//   3   + -
//   4   << >>
//   5   < <= > >=
//   6   != ==
//   7   &
//   8   ^
//   9   |
//   10  && and
//   11  or ||
//   12  ..
//   13  %= &= *= += -= /= <<= >>= ^= |=
//   14  return

// Assign Operators
//   ::= newSlot
//   :=  setSlot
//   =   updateSlot

// To add a new operator: OperatorTable addOperator("+", 4) and implement the + message.
// To add a new assign operator: OperatorTable addAssignOperator("=", "updateSlot") and implement the updateSlot message.
```

æ¶ˆæ¯ï¼šç”± sender target arguments ç»„æˆ

```io
// call å¯ä»¥è®¿é—®æ¶ˆæ¯çš„å…ƒä¿¡æ¯
a myTargets := method(call target)
a mySender := method(call sender)
a myMessageName := method(call message name)
a myMessageArgs := method(call message arguments)

a myTargets // => a
a mySender // => Object proto
a myMessageName // => myMessageName
a myMessageArgs(1, 2) // => list(1, 2)
```

```io
myif := method(
  (call sender doMessage(call message argAt(0))) ifTrue(
  call sender doMessage(call message argAt(1))) ifFalse(
  call sender doMessage(call message argAt(2)))
)

myif(foo == bar, write("true\n"), write("false\n"))
```

## DSL

ğŸ¤£åš XOR

```io
OperatorTable addOperator("ğŸ¤£", 11)
OperatorTable println
true ğŸ¤£ := method(bool, if(bool, false, true))
false ğŸ¤£ := method(bool, if(bool, true, false))

true ğŸ¤£ true print // => false
true ğŸ¤£ false print // => true
```

è§£æ JSON

```io
// Make the : an operator so we can parse JSON kv-pairs
OperatorTable addAssignOperator(":", "atPutNumber")

// Because atPut already stringifies the key, we string the extra quotes
Map atPutNumber := method(
  self atPut(
    call evalArgAt(0) asMutable removePrefix("\"") removeSuffix("\""),
    call evalArgAt(1)
  )
)

// Fires whenever the parser encounters curly brackets
curlyBrackets := method (
  writeln("Parsing curly brackets")
  r := Map clone
  call message arguments foreach(arg,
    writeln("An arg: ", arg)
    r doMessage(arg)
  )
  r
)

s := File with("phonebook.json") openForReading contents
// doString evaluates text as Io source code
phoneNumbers := doString(s)

phoneNumbers keys println // => list("Bob Smith", "Mary Walsh")
phoneNumbers values println // => list("5195551212", "4162223434")
```

method_missingï¼šç¼–å†™ç®€æ˜“ HTML

Io ä¸­çš„ method_missing æ˜¯ç±»çš„ forward

```io
Builder := Object clone
Builder forward := method(
  writeln("<", call message name, ">")
  call message arguments foreach(
    arg,
    content := self doMessage(arg);
    if(content != nil, if(content type == "Sequence", writeln(content)))
  )
  writeln("</", call message name, ">")
)

Builder ul(
  li("Io")
)
// <ul>
// <li>
// Io
// </li>
// </ul>
```

JavaScript ä¸­é€šè¿‡æ¨¡ç‰ˆå­—ç¬¦ä¸²å®ç°ç±»ä¼¼åŠŸèƒ½

## å¹¶å‘

[Io å¹¶å‘](https://iolanguage.org/guide/guide.html#Concurrency)

å¼‚æ­¥æ¶ˆæ¯ï¼š@ å‰ç¼€çš„æ¶ˆæ¯è¿”å› futureï¼Œ@@ å‰ç¼€çš„æ¶ˆæ¯è¿”å› nil å¹¶åœ¨è‡ªèº«ä¸Šä¸‹æ–‡ä¸­è§¦å‘æ¶ˆæ¯

åç¨‹ï¼šâ€œè½»é‡çº§çº¿ç¨‹â€

å¯ä»¥æƒ³è±¡æˆå¸¦æœ‰å¤šä¸ªå…¥å£å’Œå‡ºå£çš„å‡½æ•°ï¼Œæ¯æ¬¡ yield éƒ½ä¼šä¿å­˜å½“å‰ä¸Šä¸‹æ–‡ï¼Œå¹¶æŠŠæ§åˆ¶æƒäº¤ç»™å¦ä¸€ä¸Šä¸‹æ–‡å½“ä¸­

```io
// coroutine.io
odd := Object clone
odd numbers := method(
  1 println
  yield
  3 println
  yield
)

even := Object clone
even numbers := method(
  yield
  2 println
  yield
  4 println
)

odd @@numbers
even @@numbers

Coroutine currentCoroutine pause

// $ io coroutine.io
// 1
// 2
// 3
// 4
// Scheduler: nothing left to resume so we are exiting
```

actorï¼šèƒ½æ¥æ”¶æ¶ˆæ¯å¹¶åŸºäºå…¶æ‰§è¡Œè¿ç®—ï¼Œä¹Ÿå¯ä»¥å‘é€æ¶ˆæ¯ç»™å…¶ä»– Actorã€‚Actors ä¹‹é—´ç›¸äº’éš”ç¦»ï¼Œå®ƒä»¬ä¹‹é—´å¹¶ä¸å…±äº«å†…å­˜

ä¸€ä¸ª actor åªèƒ½æ”¹å˜è‡ªèº«çš„çŠ¶æ€ï¼Œå¹¶é€šè¿‡ä¸¥æ ¼çš„é˜Ÿåˆ—æ¥è§¦å…¶ä»– actorï¼Œè€Œçº¿ç¨‹å¯ä»¥ä¸å—é™åˆ¶çš„æ”¹å˜å½¼æ­¤çŠ¶æ€ï¼Œæœ‰ç«äº‰æ¡ä»¶çš„å¹¶å‘é—®é¢˜

Io ä¸­å‘é€å¼‚æ­¥æ¶ˆæ¯çš„å¯¹è±¡å°±æ˜¯ actor

```io
slower := Object clone
faster := Object clone
slower start := method(wait(2); writeln("slowly"))
faster start := method(wait(1); writeln("fastly"))

slower start; faster start
// 2s => "slowly"
// 3s => "fastly"

slower @@start; faster @@start; wait(3) // slower actor æ¥æ”¶ start æ¶ˆæ¯åˆ°é˜Ÿåˆ—ï¼Œæ‰§è¡Œï¼›faster actor æ¥æ”¶ start æ¶ˆæ¯åˆ°é˜Ÿåˆ—ï¼Œæ‰§è¡Œ
// 1s => "fastly"
// 2s => "slowly"
```

futureï¼š@ è°ƒç”¨æ¶ˆæ¯æ—¶è¿”å›ï¼Œä¸€æ®µæ—¶é—´åä¼šå˜æˆç»“æœå€¼ï¼Œå¦‚æœæœªäº§ç”Ÿç»“æœæ˜¯ä½¿ç”¨ future å°±ä¼šé˜»å¡ç›´åˆ°äº§ç”Ÿç»“æœ

ç±»ä¼¼äº JavaScript ä¸­çš„ async/awaitï¼ˆasync/await é€šè¿‡ Promise å®ç°ï¼Œä½†å†™æ³•ä¸Š future æ›´åƒ async/awaitï¼‰

## think

å ç”¨ç©ºé—´å°ï¼Œå®¹æ˜“å®‰è£…

å¯¹è±¡ä¸æ¶ˆæ¯ï¼Œç®€å•å¼ºå¤§

ç®€æ´çš„è¯­æ³•ï¼ŒLisp + OOP

å¾ˆè‡ªç”±ï¼ŒDSL èƒ½åŠ›å¼ºå¤§

å…ˆè¿›çš„å¹¶å‘æ¨¡å‹

æ€§èƒ½ä¸è¡Œ

ç¤¾åŒºå¤ªå¤ªå¤ªå¤ªå°
